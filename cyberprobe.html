<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This manual is for Cyberprobe (version 0.81, 24 January 2017),
which is an example in the Texinfo documentation.

Copyright (C) 2013-2014 Cyber MacGeddon

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with no Front-Cover Texts, and with no Back-Cover
Texts.  A copy of the license is included in the section entitled
"GNU Free Documentation License". -->
<!-- Created by GNU Texinfo 6.1, http://www.gnu.org/software/texinfo/ -->
<head>
<title>Cyberprobe 0.81</title>

<meta name="description" content="Cyberprobe 0.81">
<meta name="keywords" content="Cyberprobe 0.81">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="#Top" rel="start" title="Top">
<link href="#Index" rel="index" title="Index">
<link href="dir.html#Top" rel="up" title="(dir)">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<h1 class="settitle" align="center">Cyberprobe 0.81</h1>





<a name="Top"></a>
<div class="header">
<p>
Next: <a href="#Overview" accesskey="n" rel="next">Overview</a>, Up: <a href="dir.html#Top" accesskey="u" rel="up">(dir)</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Cyberprobe"></a>
<h1 class="top">Cyberprobe</h1>

<p>This is the manual for Cyberprobe (version 0.81, 24 January 2017).
</p>
<img src="cyberprobe-overview.png" alt="png">

<p>Cyberprobe is a distrbuted architecture for real-time monitoring of networks
against attack. This has applications in network monitoring,
intrusion detection, forensic analysis, and as a defensive platform during
an attack.
</p>
<p>The software consists of a number of components, including:
</p>
<ul>
<li> a probe, which collects data packets and forwards it over a network in
standard streaming protocols.

</li><li> a monitor, which receives the streamed packets, decodes the protocols, and
interprets the information.

</li></ul>

<p>These components can be used together or separately. For a simple
configuration, they can be run on the same host, for more complex
environments, a number of probes can feed a single monitor. For more detail,
and to see where we are going, read the <a href="#Architecture">Architecture</a> page.
</p>
<blockquote>
<p><b>Note:</b> FIXME: This manual page is slightly out-of-date, and needs to cover the
visualisation components.
</p></blockquote>

<blockquote>
<p><b>Note:</b> FIXME: Architecture diagram needs an update.
</p></blockquote>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Overview" accesskey="1">Overview</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Obtaining-the-software" accesskey="2">Obtaining the software</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Quick-start-tutorial" accesskey="3">Quick start tutorial</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Running-cyberprobe_002fcybermon" accesskey="4">Running cyberprobe/cybermon</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-pub_002fsub-infrastructure" accesskey="5">The pub/sub infrastructure</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Reference" accesskey="6">Reference</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Architecture" accesskey="7">Architecture</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Adding-a-map-to-the-dashboard" accesskey="8">Adding a map to the dashboard</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#GNU-Free-Documentation-License" accesskey="9">GNU Free Documentation License</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Index">Index</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>


<hr>
<a name="Overview"></a>
<div class="header">
<p>
Next: <a href="#Obtaining-the-software" accesskey="n" rel="next">Obtaining the software</a>, Previous: <a href="#Top" accesskey="p" rel="prev">Top</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Overview-1"></a>
<h2 class="chapter">1 Overview</h2>

<a name="index-Overview-of-Cyberprobe"></a>
<a name="Summary"></a>
<h3 class="heading">Summary</h3>

<p>Cyberprobe is a distrbuted architecture for real-time monitoring of networks
against attack. The software consists of a number of components, including:
</p>
<ul>
<li> a probe, which collects data packets and forwards it over a network in
standard streaming protocols.

</li><li> a monitor, which receives the streamed packets, decodes the protocols, and
interprets the information.

</li></ul>

<a name="index-cyberprobe_002c-features"></a>
<a name="index-Features_002c-of-cyberprobe"></a>

<p>These components can be used together or separately. For a simple
configuration, they can be run on the same host, for more complex
environments, a number of probes can feed a single monitor. For more detail,
and to see where we are going, read the <a href="#Architecture">Architecture</a> page.
</p>
<p>The probe, <code>cyberprobe</code> has the following features:
</p>
<ul>
<li> The probe can be tasked to collect packets from an interface and forward any
which match a configurable address list.

</li><li> The probe can be configured to receive Snort alerts. In this configuration,
when an alert is received from Snort, the IP source address associated with
the alert is dynamically targeted for a period of time. In such a
configuration, the system will collect data from any network actor who
triggers a snort rule and is thus identified as a potential attacker.

</li><li> The probe can optionally run a management interface which allows remote
interrogation of the state, and alteration of the configuration. This
allows dynamic alteration of the targeting map, and integration with other
systems.

</li><li> The probe can be configured to deliver on one of two standard stream
protocols.

</li></ul>

<a name="index-cybermon_002c-features"></a>
<a name="index-Features_002c-of-cybermon"></a>

<p>The monitor tool, <code>cybermon</code> has the following features:
</p>
<ul>
<li> Collects packets delivered in stream protocols.

</li><li> Decodes packet protocols in and raises events in near-real-time.

</li><li> Decoded information is made available to user-configurable logic to define
how the decoded data is handled. A simple configuration language is used
(LUA) and example configurations are provided to monitor data volumes,
display data hexdumps, or stash the data in files.

</li><li> Packet forgery techniques are included, which allow resetting TCP
connections, and forging DNS responses. This can be invoked from your LUA in
order to fight back against attacks on your network.

</li><li> Supports IP, TCP, UDP, ICMP, HTTP and DNS protocols, currently.

</li></ul>

<p>The cybermon software is a bit of a work-in-progress at the moment, and
needs more protocols added, but there&rsquo;s enough capability to be useful, and
to demonstrate the value of this architecture.
</p>
<p>The code is targeted at the Linux platform, although it is generic enough to
be applicable to other UN*X-like platforms.
</p>
<p>The easiest way to learn about the software is to follow our Quick Start
tutorial.
</p>
<a name="index-Cyberprobe_002c-motivation"></a>
<a name="Motivation"></a>
<h3 class="heading">Motivation</h3>

<p>Cyberprobe started out as a research tool to study networked applications to
find out what they were doing, as we all know how software suppliers
sometimes like to add some &quot;extras&quot; to their software :). So, a simple tool
to configure how packets are captured from a network was produced. But as
you are probably aware, the biggest threat to the safety of your information
is from outside of your network. Thus, the ability to trigger collection of
packets upon detection of a Snort rule hit was added.
</p>
<p>Snort is a powerful IDS system which studies packets on your network,
analyses them against a set of signatures and creates logs and alerts. We
felt there was a need to harness the Snort alerts, but use them to trigger
collection and forwarding of packets from the address which caused the
alert.
</p>
<p>You may be asking why you&rsquo;d want to use Cyberprobe? After all, monitoring
networks with tcpdump and Snort and collecting alerts and packet data for
analysis is a straightforward process for many networks. However, real-time
analysis is not possible if everything is file based. Collecting the data
and forwarding over the network to a central collection point allows for a
much more &quot;industrialised&quot; approach to intrusion detection. If you detect an
attack attempt, and then observe vast quantities of data leaving your
network from the credit card accounts database, then you know you need to
act quickly.
</p>
<p>You need flexibility about how you monitor for network attacks. There isn&rsquo;t
a one-size-fits-all solution. Attackers are ingenious in their approach to
attacking your network, so you need to have a flexible, configurable
monitoring tool to develop your defences.
</p>
<a name="index-Cybermaggedon"></a>
<a name="index-Prophesy-of-doom"></a>
<a name="Warning"></a>
<h3 class="heading">Warning</h3>

<p>There&rsquo;s a war coming... The enemy is resourceful, they can use your networks
and systems as their own weapon. But with the right tools, you can prepare a
defence. It&rsquo;s time to get ready for Cybermaggedon.
</p>
<a name="index-Release-history"></a>
<a name="index-Version-history"></a>
<a name="Revision-history"></a>
<h3 class="heading">Revision history</h3>

<p>Cyberprobe releases:
</p>
<dl compact="compact">
<dt><code>0.80</code></dt>
<dd><p>Added optional TLS support for packet streams to cyberprobe and cybermon.
This change refactors the cybermon command line interface.  See documentation
for new command line options.
</p>
</dd>
<dt><code>0.79</code></dt>
<dd><p>Socket closure fix.
</p>
</dd>
<dt><code>0.76</code></dt>
<dd><p>Make UUIDs unique.
</p>
</dd>
<dt><code>0.74</code></dt>
<dd><p>Cassanda subscriber support.
</p>
</dd>
<dt><code>0.71</code></dt>
<dd><p>Fixes.
</p>
</dd>
<dt><code>0.70</code></dt>
<dd><p>Added ZeroMQ pub/sub support, with subscribers for ElasticSearch, Gaffer,
Google BigQuery.
</p>
</dd>
<dt><code>0.63</code></dt>
<dd><p>ElasticSearch integration brought up to latest ES verison.
Cybermon Gaffer integration work completed to point of release.
</p>
</dd>
<dt><code>0.62</code></dt>
<dd><p>Source-code updated to work with latest dependencies, operating systems and
compiler versions.  Early Gaffer integration.
</p>
</dd>
<dt><code>0.61</code></dt>
<dd><p>Fixed HTTP crashing problem in cybermon.
</p>
</dd>
<dt><code>0.60</code></dt>
<dd><p>IP address matching now permits specification of a mask.
Documentation improved, regression suite added, a few unit tests starting to
form.  
</p>
</dd>
<dt><code>0.55</code></dt>
<dd><p>Packages released for Debian, Fedora and Centos, documentation
re-worked into info and man formats.
</p>
</dd>
<dt><code>0.50</code></dt>
<dd><p>ElasticSearch integration improved to get a much tighter integration with
Kibana for a network dashboard. Also bug-fixes for memory management / lock
problems.
</p>
</dd>
<dt><code>0.40</code></dt>
<dd><p>Now includes prototype STIX support: A TAXII server allows distrubution of
threat information, and a TAXII client can read indicator information and
store in a way that cybermon can use.
</p>
</dd>
<dt><code>0.30</code></dt>
<dd><p>The build process now uses the GNU toolset. It detects the LUA interface and
can compile against LUA 5.1 and 5.2. Successfully compiled on a MacBook!
</p>
</dd>
<dt><code>0.25</code></dt>
<dd><p>Added SMTP and FTP capability. Also added a primitive mechanism to visualise
network observations.
</p>
</dd>
<dt><code>0.20</code></dt>
<dd><p>HTTP and DNS protocol capability. TCP reset and DNS packet forgery
added. Major overhaul of the LUA language interface.
</p>
</dd>
<dt><code>0.12</code></dt>
<dd><p>Cybermon utility is configurable using LUA.
</p>
</dd>
<dt><code>0.11</code></dt>
<dd><p>Added basic cybermon utility.
</p>
</dd>
<dt><code>0.10</code></dt>
<dd><p>Added management interface.
</p>
</dd>
<dt><code>0.9</code></dt>
<dd><p>First release on SourceForge.
</p>
</dd>
</dl>


<hr>
<a name="Obtaining-the-software"></a>
<div class="header">
<p>
Next: <a href="#Quick-start-tutorial" accesskey="n" rel="next">Quick start tutorial</a>, Previous: <a href="#Overview" accesskey="p" rel="prev">Overview</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Obtaining-the-software-1"></a>
<h2 class="chapter">2 Obtaining the software</h2>

<p>The code doesn&rsquo;t have many dependencies. Exotic dependencies are:
</p>
<a name="index-dependencies"></a>
<a name="index-Build-dependencies"></a>
<a name="index-Boost"></a>
<a name="index-Lua"></a>
<a name="index-libpcap"></a>
<a name="index-expat"></a>
<a name="index-tcpdump"></a>
<a name="index-telnet"></a>
<a name="index-luafilesystem"></a>
<a name="index-luajson"></a>
<a name="index-libtaxii"></a>
<a name="index-stix"></a>
<a name="index-lua_002dmd5"></a>
<a name="index-ncurses"></a>
<a name="index-readline"></a>

<ul>
<li> Boost regex.

</li><li> Boost shared pointer.

</li><li> LUA - 5.1 or later.

</li><li> GCC C++ compiler and development support.

</li><li> <code>libpcap</code>.

</li><li> Expat (XML parser).

</li><li> <code>tcpdump</code> - not needed to build the software, but we use it in the
tutorial.

</li><li> <code>telnet</code> - not needed to build the software, but we use it in the
tutorial.

</li><li> <code>luafilesystem</code>, if using certain Lua configuration files.

</li><li> <code>luajson</code>, if using certain Lua configuration files.

</li><li> <code>lua-md5</code>, for MD5 hashing payloads.

</li><li> <code>ncurses</code>, needed for the command line admin utility.

</li><li> <code>readline</code>, needed for the command line admin utility.

</li><li> For STIX support, <code>libtaxii</code> and <code>stix</code> are Python modules
made available at <a href="http://mitre.org">http://mitre.org</a> which can be downloaded using
<code>pip</code>.

</li></ul>

<p>There are a number of ways to obtain the software:
</p>
<a name="Download-packages"></a>
<h3 class="heading">Download packages</h3>

<p>The easiest way to obtain the software is to download the package for the
operating system you are using.  Packages are currently available for:
</p>
<ul>
<li> Fedora 24, 64-bit.

</li><li> Debian Jessie, 64-bit.

</li><li> Ubuntu, 64-bit.  FIXME: What version?

</li></ul>

<p>Downloads are available on the project page at
<a href="http://cyberprobe.sourceforge.net">http://cyberprobe.sourceforge.net</a>.
</p>
<p>Fedora packages are installed using <code>yum</code>:
</p>
<div class="example">
<pre class="example">sudo dnf install &lt;package&gt;
</pre></div>

<p>Debian, Mint and Ubuntu packages are installed using <code>dpkg</code>:
</p>
<div class="example">
<pre class="example">sudo dpkg -i &lt;package&gt;
</pre></div>

<p>If there are dependency errors e.g. because you don&rsquo;t have some dependencies
installed, you can install them thus:
</p>
<div class="example">
<pre class="example">sudo apt-get install -f
</pre></div>

<a name="Install-from-source"></a>
<h3 class="heading">Install from source</h3>

<p>Note: on many platforms, installing a package just adds the &quot;run time&quot; part
of the code. In order to be able to compile code against the run time, you
need to install a separate &quot;developers kit&quot; package. On Fedora, for
instance, both <code>libpcap</code> and <code>libpcap-devel</code> are needed in order to
be able to build this code from source.
</p>
<p>Note also that <code>lua</code> packages can be a little strange: sometimes the
package will exist in your distribution, at other times you need to install a
utility called <code>luarocks</code> to install the package.
</p>
<p>Source downloads are available on the project page at
<a href="http://cyberprobe.sourceforge.net">http://cyberprobe.sourceforge.net</a>, look for the <samp>.tar.gz</samp> file.
</p>
<p>These files can be unwrapped, then configured:
</p>
<div class="example">
<pre class="example">tar xvfz cyberprobe-X.Y.tar.gz
cd cyberprobe-X.Y
./configure
make
sudo make install
</pre></div>

<p><samp>README.linux</samp> provides some hints for Linux users.
If installing on MacOS, read <samp>README.mac</samp>.
</p>
<a name="index-Checkout-from-git-repository"></a>
<a name="index-git-repository"></a>
<a name="Installing-from-git"></a>
<h3 class="heading">Installing from git</h3>

<p>To checkout the latest code using git:
</p>
<div class="example">
<pre class="example">git clone http://git.code.sf.net/p/cyberprobe/code cyberprobe
</pre></div>

<p>To build, use:
</p>
<div class="example">
<pre class="example">autoreconf -fi
./configure
make
sudo make install
</pre></div>

<p>Powered by SourceForge, project page is at
<a href="http://www.sourceforge.net/p/cyberprobe">http://www.sourceforge.net/p/cyberprobe</a>.
</p>
<a name="index-Docker"></a>
<a name="index-Containers"></a>
<a name="index-Cyberprobe_002c-docker-repository"></a>
<a name="index-cyberprobe_002c-docker-repository"></a>
<a name="index-cybermon_002c-docker-repository"></a>
<a name="Docker-repository"></a>
<h3 class="heading">Docker repository</h3>

<p>There are two Docker repositories containing the Cyberprobe distribution.
See <a href="http://hub.docker.com/r/cybermaggedon/cyberprobe">http://hub.docker.com/r/cybermaggedon/cyberprobe</a>.
</p>
<ul>
<li> <code>docker.io/cybermaggedon/cyberprobe</code>

</li><li> <code>docker.io/cybermaggedon/cybermon</code>

</li></ul>

<p>The only difference is the default command which is executed on running
the container.  Here are some container invocations you may find useful:
</p>
<ul>
<li> Run <code>cyberprobe</code>.  You will need to create a configuration file
and map it in to the container.
<div class="example">
<pre class="example">sudo docker -it --rm -v /etc/cyberprobe:/etc/cyberprobe_host \
  docker.io/cybermaggedon/cyberprobe \
  cyberprobe /etc/cyberprobe_host/cyberprobe.fg
</pre></div>

</li><li> Run <code>cybermon</code>.  The <code>cybermon</code> container exposes ports
9000 and 5555.
<div class="example">
<pre class="example">sudo docker -it --rm -p 9000:9000 -v \
  --net=host --privileged --cap-add=NET_ADMIN \
  docker.io/cybermaggedon/cybermon \
  cybermon /etc/cyberprobe/zeromq.lua
</pre></div>

</li><li> Run <code>cybermon-cassandra</code>.  You need to know the IP address
of the host side of the Docker bridge network, and provide addresses
of the Cassandra servers.
<div class="example">
<pre class="example">sudo docker -it --rm -v \
  docker.io/cybermaggedon/cybermon \
  cybermon-cassandra tcp://147.146.0.1:5555 10.142.146.6,10.142.146.8
</pre></div>

</li></ul>

<p>Running cyberprobe in a container makes the deployment easier, but it needs
to run with elevated privileges in order to sniff the network, which reduces
some of the advantages of running it in a container.
</p>

<hr>
<a name="Quick-start-tutorial"></a>
<div class="header">
<p>
Next: <a href="#Running-cyberprobe_002fcybermon" accesskey="n" rel="next">Running cyberprobe/cybermon</a>, Previous: <a href="#Obtaining-the-software" accesskey="p" rel="prev">Obtaining the software</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Quick-start-tutorial-1"></a>
<h2 class="chapter">3 Quick start tutorial</h2>
<a name="index-Getting-started"></a>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Preparation" accesskey="1">Preparation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Using-cyberprobe" accesskey="2">Using <code>cyberprobe</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Management-interface" accesskey="3">Management interface</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Integration-with-snort" accesskey="4">Integration with <code>snort</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Using-cybermon" accesskey="5">Using <code>cybermon</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Writing-your-own-configuration-file" accesskey="6">Writing your own configuration file</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Visualisation" accesskey="7">Visualisation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Threat-indicators-using-STIX" accesskey="8">Threat indicators using STIX</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>


<hr>
<a name="Preparation"></a>
<div class="header">
<p>
Next: <a href="#Using-cyberprobe" accesskey="n" rel="next">Using <code>cyberprobe</code></a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Preparation-1"></a>
<h3 class="section">3.1 Preparation</h3>

<a name="index-Building"></a>
<a name="index-Downloading"></a>
<a name="index-Compilation"></a>
<a name="index-Packages"></a>
<a name="index-Installation"></a>
<a name="Build-software"></a>
<h3 class="heading">Build software</h3>

<p>For installation, see <a href="#Obtaining-the-software">Obtaining the software</a>.
There&rsquo;s a fair amount of development taking place in the git repository, so
you probably want to get the a package, or use the latest release on the
downloads page (<a href="http://sourceforge.net/projects/cyberprobe/files/">http://sourceforge.net/projects/cyberprobe/files/</a>).
</p>
<a name="index-Executables"></a>
<a name="index-Build-targets"></a>

<p>The compilation process compiles the following commands:
</p>
<dl compact="compact">
<dd>
<a name="index-cyberprobe"></a>
</dd>
<dt><code>cyberprobe</code></dt>
<dd><p>Packet capture.
</p>
<a name="index-cybermon"></a>
</dd>
<dt><code>cybermon</code></dt>
<dd><p>Data analyser, analyses the data streams and reports events.
</p>
<a name="index-etsi_002drcvr"></a>
</dd>
<dt><code>etsi-rcvr</code></dt>
<dd><p>Test decoder for ETSI format data.
</p>
<a name="index-cyberprobe_002dcli"></a>
</dd>
<dt><code>cyberprobe-cli</code></dt>
<dd><p>Cyberprobe control command-line client.
</p>
<a name="index-cybermon_002dbigquery"></a>
</dd>
<dt><code>cybermon-bigquery</code></dt>
<dd><p>Pub/sub subscriber, delivers events to Google Bigquery.
</p>
<a name="index-cybermon_002dcassandra"></a>
</dd>
<dt><code>cybermon-cassandra</code></dt>
<dd><p>Pub/sub subscriber, delivers events to Cassandra.
</p>
<a name="index-cybermon_002delasticsearch"></a>
</dd>
<dt><code>cybermon-elasticsearch</code></dt>
<dd><p>Pub/sub subscriber, delivers events to ElasticSearch.
</p>
<a name="index-cybermon_002dgaffer"></a>
</dd>
<dt><code>cybermon-gaffer</code></dt>
<dd><p>Pub/sub subscriber, delivers events to Gaffer.
</p>
</dd>
</dl>

<a name="index-Discussion-forums"></a>

<p>If it installs / builds without errors, then it&rsquo;s time to start something up. 
If you have problems you can&rsquo;t resolve head to the discussion forums
(<a href="https://sourceforge.net/p/cyberprobe/discussion/">https://sourceforge.net/p/cyberprobe/discussion/</a>).
</p>
<a name="index-Network-parameters"></a>
<a name="Establish-network-parameters"></a>
<h3 class="heading">Establish network parameters</h3>

<p>The simplest way to use cyberprobe is to use it on a Linux workstation, or
in a virtual machine.  Maybe you&rsquo;re using a Linux desktop now now?  If so,
you could use it to capture all the data going to/from the internet. This
will be a static configuration in order to keep things simple. We&rsquo;ll do
dynamic tracking later.
</p>
<p>In the next few steps, you&rsquo;ll use <code>cyberprobe</code> to capture some data,
on your workstation, and stream it to <code>etsi-rcvr</code> so that you know it&rsquo;s
working. But first, you&rsquo;ll need to collect some information about your
configuration.
</p>
<a name="index-ifconfig"></a>

<p>You need to know the name of the network interface you are using. The
command <code>/sbin/ifconfig</code> will show you all the network interfaces
your machine knows about. e.g.
</p>
<div class="example">
<pre class="example">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10
        [etc.]

eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500
        inet 192.168.1.80  netmask 255.255.255.0
        inet6 fe80::a60:6eff:fe81:7a75  prefixlen 64
        [etc.]
</pre></div>

<p>The lo interface is a loopback interface, and isn&rsquo;t really on the network,
so ignore that. It&rsquo;s an interface that gets packets going to
<code>127.0.0.1</code> and makes sure they end up handled by your
workstation. Your interface is quite likely to be called something like
eth0. The other thing you need to know is the IP address of your
workstation. The IP address is associated with an interface, so in the above
example, I can see I have an IP address <code>192.168.1.80</code>.
</p>
<p>Note: on some networks (like mine) the IP address is allocated
dynamically. In my case, the IP address is allocated by the broadband
router. If things aren&rsquo;t working as you expect, you should check your IP
address to check your workstation hasn&rsquo;t been allocated a new, different
address. In my case, I can tell the broadband router to permanently allocate
a particular IP address to this workstation, so that it won&rsquo;t change.
</p>

<hr>
<a name="Using-cyberprobe"></a>
<div class="header">
<p>
Next: <a href="#Management-interface" accesskey="n" rel="next">Management interface</a>, Previous: <a href="#Preparation" accesskey="p" rel="prev">Preparation</a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Using-cyberprobe-1"></a>
<h3 class="section">3.2 Using <code>cyberprobe</code></h3>
<a name="index-cyberprobe-1"></a>
<a name="index-cyberprobe-configuration"></a>

<a name="Starting-cyberprobe-with-a-configuration-file"></a>
<h3 class="heading">Starting cyberprobe with a configuration file</h3>

<p>The source code contains a file <samp>config.xml</samp> which is a good template
for any configuration you&rsquo;re going to build. However, for the purpose of
this discussion, let&rsquo;s start from scratch. In order to do anything useful,
there are three essential elements to a cyberprobe configuration file:
interfaces, targets and endpoints. The system won&rsquo;t do anything useful
without those three configuration elements defined. Let&rsquo;s start with a very
simple configuration.
</p>
<p>Using your favourite text editor, create a text file, say <samp>c.xml</samp> with the
following contents:
</p>
<div class="example">
<pre class="example">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;

&lt;configuration&gt;

  &lt;interfaces&gt;
    &lt;interface name=&quot;eth0&quot;/&gt;
  &lt;/interfaces&gt;

  &lt;targets&gt;
  &lt;/targets&gt;

  &lt;endpoints&gt;
  &lt;/endpoints&gt;

&lt;/configuration&gt;
</pre></div>

<p>Note: You should replace the <code>eth0</code> string with the name of your
network interface. Remember? We discovered that when playing with the
<code>ifconfig</code> command.
</p>
<a name="index-Privileged-user"></a>

<p>We&rsquo;re ready to roll. We need to run as a privileged used because cyberprobe
captures data off the network interface. So, running as root, you need to
locate the place where you compiled the code, and run <code>cyberprobe</code>
giving it the name of the configuration file you just created:
</p>
<div class="example">
<pre class="example">cyberprobe c.xml
</pre></div>

<p>If everything goes to plan, you should see the following output:
</p>
<div class="example">
<pre class="example">Capture on interface eth0 started.
</pre></div>

<p>If you see an error message, the obvious two things to check are:
</p>
<ul>
<li> Did you name a network interface correctly? See <code>ifconfig</code>
discussion above.

</li><li> Are you running as a privileged user?

</li></ul>

<p>If you see no output at all, check that your configuration file is correct.
</p>
<p>Once you are seeing the &quot;Capture on interface eth0&quot; line, then you&rsquo;ve
achieved success in this step, and are ready to move on.
</p>
<p>If you have everything working, there&rsquo;s one thing to note before moving on:
cyberprobe treats a broken configuration file the same as an empty
configuration file. With cyberprobe running, edit the configuration file,
and delete the query (&lsquo;<samp>?</samp>&rsquo;) prefix in the first line, so that it looks like
this:
</p>
<div class="example">
<pre class="example">&lt;xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
</pre></div>

<p>You&rsquo;ve now broken the configuration file. It&rsquo;s not valid XML any more, so
the parsing fails. You should see this output from <code>cyberprobe</code>:
</p>
<div class="example">
<pre class="example">Capture on interface eth0 stopped.
</pre></div>

<p>If you repair the damage to the configuration file, everything will start
working again. The lesson here is: If you find that <code>cyberprobe</code>
won&rsquo;t recognise any resources, it&rsquo;s likely that your configuration file is
invalid. The utility <code>xmlwf</code>x can be useful to check that an XML
configuration file is valid, if you&rsquo;re not getting the results you expect.
</p>
<a name="index-Target"></a>
<a name="index-cyberprobe_002c-target"></a>
<a name="Adding-a-target"></a>
<h3 class="heading">Adding a target</h3>

<p>We have <code>cyberprobe</code> running, but it isn&rsquo;t doing anything
useful. Remember, I said that a useful configuration consists of three
minimal elements: interfaces, targets and endpoints? Well, currently we only
have interfaces defined. That means that <code>cyberprobe</code> is capturing
packets off of the network, but throwing them away.
</p>
<p>Let&rsquo;s add a target. Edit the targets block of the configuration file. We
need an entry describing the IP address of my workstation. Remember? We
discovered that with the ifconfig command earlier? Instead of
<code>192.168.1.80</code> use the IP address of your workstation.
</p>
<div class="example">
<pre class="example">&lt;targets&gt;
  &lt;target address=&quot;192.168.1.80&quot; liid=&quot;123456&quot;/&gt;
&lt;/targets&gt;
</pre></div>

<p>If successful, you should see new output from <code>cyberprobe</code>:
</p>
<div class="example">
<pre class="example">Added target 192.168.1.80 -&gt; 123456.
</pre></div>

<p>The target configuration allows specification of IPv4 and IPv6 addresses, and
addresses can include a mask, which allows IP address matching to be applied
in a wildcard configuration.  See <a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a>
</p>
<p>At this step, we&rsquo;re capturing packets, spotting target addresses, but as
there&rsquo;s no endpoint defined there&rsquo;s still nowhere to send the data. So, this
is still a useless configuration. On to the next step...
</p>
<a name="Adding-an-endpoint-1"></a>
<h3 class="heading">Adding an endpoint</h3>
<a name="Adding-an-endpoint"></a>
<p>Adding an endpoint to the configuration file will define a place where the
captured data is sent. Before adding an endpoint, let&rsquo;s make sure there&rsquo;s
something ready to receive the data.
</p>
<p>In a separate terminal window, navigate to the <code>cyberprobe</code> build,
and run:
</p>
<a name="index-etsi_002drcvr-1"></a>

<div class="example">
<pre class="example">etsi-rcvr 10000 | tcpdump -n -r -
</pre></div>

<p>The <code>etsi-rcvr</code> program opens a TCP port listening on port 10000 for
a stream of ETSI data, and on standard output, writes the IP packets it sees
in PCAP format. The tcpdump command receives this PCAP data, and outputs
packet summaries.
</p>
<p>If that starts successfully, the next step is to plumb a connection from
<code>cyberprobe</code> to <code>etsi-rcvr</code>.
</p>
<p>Next, edit the configuration file, and edit the endpoints block to deliver
packets to a local service on port 10000:
</p>
<a name="index-Endpoint"></a>
<a name="index-cyberprobe_002c-endpoint"></a>

<div class="example">
<pre class="example">&lt;endpoints&gt;
  &lt;endpoint hostname=&quot;localhost&quot; port=&quot;10000&quot; transport=&quot;tcp&quot; type=&quot;etsi&quot;/&gt;
&lt;/endpoints&gt;
</pre></div>

<p>If that worked, you should see <code>cyberprobe</code> start the endpoint:
</p>
<div class="example">
<pre class="example">Added endpoint localhost:10000 of type etsi
</pre></div>

<p>Hopefully you&rsquo;ll start to see some output from tcpdump...
</p>
<a name="Capturing-data"></a>
<h3 class="heading">Capturing data</h3>

<p>At this step, <code>cyberprobe</code> should be forwarding an network traffic
your workstation generates to the tcpdump command, so that you see data. Any
average workstation is generating network traffic all the time, so you won&rsquo;t
need to do anything. But if you see nothing, you can do something like,
visit the Google home page in a browser on your workstation. You should see
something like this pouring from the tcpdump.
</p>
<div class="example">
<pre class="example">18:54:24.376838 IP 192.168.1.80.54249 &gt; 212.58.244.71.http: Flags [P.],
 seq 1:673, ack 1, win 115, options [nop,nop,TS val 129851063 ecr 33669
55869], length 672
18:54:24.390768 IP 212.58.244.71.http &gt; 192.168.1.80.54249: Flags [.], 
ack 673, win 124, options [nop,nop,TS val 3366955882 ecr 129851063], le
ngth 0
18:54:24.392909 IP 212.58.244.71.http &gt; 192.168.1.80.54249: Flags [P.],
 seq 1:1796, ack 673, win 124, options [nop,nop,TS val 3366955884 ecr 1
29851063], length 1795
</pre></div>

<p>At this step, it&rsquo;s worth having a quick play with the reconnection
mechanism. Stop and start <code>etsi-rcvr</code>, and you&rsquo;ll see that
<code>cyberprobe</code> reconnects automatically:
</p>
<a name="index-Connection-reset"></a>
<a name="index-Connection-restart"></a>
<a name="index-Reconnection"></a>

<div class="example">
<pre class="example">ETSI LI connection to localhost:10000 failed.
Will reconnect...
ETSI LI connection to localhost:10000 established.
</pre></div>

<p>We don&rsquo;t guarantee zero data loss on a reconnect.
</p>

<hr>
<a name="Management-interface"></a>
<div class="header">
<p>
Next: <a href="#Integration-with-snort" accesskey="n" rel="next">Integration with <code>snort</code></a>, Previous: <a href="#Using-cyberprobe" accesskey="p" rel="prev">Using <code>cyberprobe</code></a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Management-interface-1"></a>
<h3 class="section">3.3 Management interface</h3>
<a name="index-Management"></a>
<a name="index-cyberprobe_002c-management"></a>

<p>At this step, we&rsquo;ll setup a control port, and use it modify the
configuration of <code>cyberprobe</code>.
</p>
<p>First step is to modify the configuration file to include this line, just
after the <code>&lt;configuration&gt;</code> line:
</p>
<a name="index-Authentication"></a>

<div class="example">
<pre class="example">&lt;control port=&quot;8888&quot; username=&quot;admin&quot; password=&quot;mypassword&quot;/&gt;
</pre></div>

<p>That declares that a management service needs to be run on port 8888. The
authentication details are provided too. You should see this output from
<code>cyberprobe</code>:
</p>
<div class="example">
<pre class="example">Starting control on port 8888
</pre></div>

<p>That&rsquo;s good! Now need to connect and interrogate the targets list: I use
telnet to connect, the auth command to authenticate, and the target command
to see a list of commands.
</p>
<div class="example">
<pre class="example">$ telnet localhost 8888
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
auth admin mypassword
200 Authenticated.
targets
201 Targets list follows.
25
123456:ipv4:192.168.1.80/32
</pre></div>

<p>I can use the help command to see the full list of commands permitted. There
are commands for changing the address target list:
</p>
<div class="example">
<pre class="example">targets
201 Targets list follows.
25
123456:ipv4:192.168.1.80
remove_target ipv4 192.168.1.80
200 Removed target.
add_target 654321 ipv4 192.168.0.0/16
200 Added target.
</pre></div>

<p>The interface isn&rsquo;t pretty, but you get the idea. You can change almost
everything that you can manage by changing the configuration file.
</p>
<p>Note: The the management interface changes the active state of
<code>cyberprobe</code> but it doesn&rsquo;t change the configuration file. So,
configuration changes made through the management interface are &rsquo;lost&rsquo; when
you restart <code>cyberprobe</code>.
</p>
<p>Note also that you may get some weird results if you use the configuration
file AND the control interface to manage the same resources, so you probably
don&rsquo;t want to do that.
</p>
<a name="index-cyberprobe_002dcli-1"></a>

<p>The <code>cyberprobe-cli</code> command can be used to access the
management interface but provides a (slightly) nicer <code>readline</code>
interface, and has auto-completion.  Usage is of the form
</p><div class="example">
<pre class="example">cyberprobe-cli <var>host</var> <var>port</var>
</pre></div>
<p>Once you&rsquo;re in, you can type help to get help, or press TAB for auto-completion
of commands.
</p>

<hr>
<a name="Integration-with-snort"></a>
<div class="header">
<p>
Next: <a href="#Using-cybermon" accesskey="n" rel="next">Using <code>cybermon</code></a>, Previous: <a href="#Management-interface" accesskey="p" rel="prev">Management interface</a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Integration-with-snort-1"></a>
<h3 class="section">3.4 Integration with <code>snort</code></h3>
<a name="index-snort_002c-integration"></a>
<a name="index-Integration-with-snort"></a>

<p>In this step, we&rsquo;ll add the excellent IDS, Snort to the mix. If you don&rsquo;t
know Snort, it scans network traffic for patterns, and can take various
actions when those patterns are discovered. It is typically used to detect
network attacks, and the Snort folks maintain a huge collection of patterns
that will identify known network attacks. The Snort team maintain the
project at <a href="http://www.snort.org">http://www.snort.org</a>.
</p>
<p>If you want to try out the Snort integration, you need to head over to the
Snort home page, download and install Snort.  Or install the appropriate
package with your distribution.
</p>
<p>Once you have it installed, to simplify things, you&rsquo;ll want to put a
rule in place that will definitely identify things on your
network. The easiest way is to add a local rule that identifies your
workstation. First of all, you&rsquo;ll want to make sure your Snort
configuration file (probably <samp>/etc/snort/snort.conf</samp>) loads a
local rules file. So, it should contain something like this:
</p>
<a name="index-snort_002c-rules"></a>
<a name="index-snort_002c-signatures"></a>

<div class="example">
<pre class="example"># site specific rules
include $RULE_PATH/local.rules
</pre></div>

<p>Then, to identify your workstation, add a rule like this to your local rules
file (probably <samp>/etc/snort/rules/local.rules</samp>):
</p>
<div class="example">
<pre class="example">alert tcp 192.168.1.80 any -&gt; any 80 (msg:&quot;Web&quot;; 
classtype:misc-activity;sid:200; rev:1;)
</pre></div>

<p><code>cyberprobe</code> itself needs to be configured to receive Snort
alerts. You do that by adding some configuration, just after the
&lt;configuration&gt; line:
</p>
<div class="example">
<pre class="example">&lt;snort_alert socket=&quot;/var/log/snort/snort_alert&quot; duration=&quot;60&quot;/&gt;
</pre></div>

<p>That says, Snort alerts will result in dynamic collection of data for 60
seconds from identification. While you&rsquo;re in the configuration file, you can
remove the static IP address target line. Find this line and delete it:
</p>
<div class="example">
<pre class="example">&lt;target address=&quot;192.168.1.80&quot; liid=&quot;123456&quot;/&gt;
</pre></div>

<p><code>cyberprobe</code> should respond:
</p>
<a name="index-snort-alerts"></a>

<div class="example">
<pre class="example">Removed target 192.168.1.80 -&gt; 123456.
Start snort alerter on /var/log/snort/snort_alert
</pre></div>

<p>Now I can run Snort in IDS mode. Snort needs to run as &rsquo;root&rsquo;:
</p>
<div class="example">
<pre class="example">snort -i eth0 -A unsock -N -l /var/log/snort/ -c /etc/snort/snort.conf
</pre></div>

<p>Thanks to our Snort rule, when our workstation generates network data, Snort
will detect it, trigger our rule, and alert <code>cyberprobe</code>. You should
see <code>cyberprobe</code> say:
</p>
<div class="example">
<pre class="example">Hit on signature ID 200, targeting 192.168.1.80
</pre></div>

<p>Also, once the rule is triggered, you should see evidence of packet data
from the <code>tcpdump</code> command, as before. <code>cyberprobe</code> causes
the targeting to time out after a period of time. If further alerts are
seen, the targeting lifetime is targeted. If no further alerts are seen the
IP address targeting is deleted. If you can convince your workstation to
stop creating network data, by e.g. not using it for a minute or so, then
you should see the rule time out:
</p>
<div class="example">
<pre class="example">Stopped targeting on 192.168.1.80
</pre></div>

<p>In practice this may be harder than you think, as workstations generate
network traffic all the time. You may have to turn off your email clients
and close the web browse. Your attempt to silence your workstation may be
further thwarted by the operating system checking for patches without you
knowing.
</p>
<a name="index-cyberprobe_002c-delay"></a>
<a name="index-Delay"></a>
<a name="Introducing-a-delay"></a>
<h3 class="heading">Introducing a delay</h3>

<p>Your Snort integration suffers from a particular problem now. The time taken
for Snort to inspect some packets, generate an alert and for
<code>cyberprobe</code> to get the IP address targeted is not zero. It is hard
to measure, but it is going to be a significant chunk of a millisecond. The
problem is that by the time <code>cyberprobe</code> is targeting the IP
address, the network attcker&rsquo;s packets have long gone. The result is, that
while <code>cyberprobe</code> is now targetting the attacker, it won&rsquo;t capture
the original network attack.
</p>
<p>Our solution is to introduce a packet delay in <code>cyberprobe</code>. The
packets entering <code>cyberprobe</code> are kept in a time-delay queue and are
processed once that delay expires. You can configure a delay, by putting the
delay attribute in an interface specfication. e.g.
</p>
<div class="example">
<pre class="example">&lt;interfaces&gt;
  &lt;interface name=&quot;eth0&quot; delay=&quot;0.2&quot;/&gt;
&lt;/interfaces&gt;
</pre></div>

<p>0.2 second should be plenty enough. You should be able to see this delay in
action: When you generate network traffic, you should be able to see the
delay between network activity taking place, and the corresponding burst of
activity from tcpdump.
</p>
<p>At this point, you&rsquo;ve completed the guided tour of <code>cyberprobe</code>, the
packet capture tool. If that&rsquo;s all you need, the rest of the tutorial will
probably have less interest to you: In the following steps, we&rsquo;ll start to
analyse and act on the captured data.
</p>

<hr>
<a name="Using-cybermon"></a>
<div class="header">
<p>
Next: <a href="#Writing-your-own-configuration-file" accesskey="n" rel="next">Writing your own configuration file</a>, Previous: <a href="#Integration-with-snort" accesskey="p" rel="prev">Integration with <code>snort</code></a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Using-cybermon-1"></a>
<h3 class="section">3.5 Using <code>cybermon</code></h3>
<a name="index-cybermon-1"></a>
<a name="index-cybermon_002c-configuration"></a>
<a name="Introducing-cybermon"></a>
<h3 class="heading">Introducing <code>cybermon</code></h3>

<p>The previous 9 steps have all been about <code>cyberprobe</code>. If you&rsquo;ve got
this far successfully, you pretty much know all there is to know about
<code>cyberprobe</code>. It is time to start doing something more useful with
all that data you are capturing. In this step we&rsquo;ll start up
<code>cybermon</code> and look at the data.
</p>
<a name="index-monitor_002elua"></a>

<p>Remember that <code>etsi-rcvr</code> command you started in step <a href="#Adding-an-endpoint">Adding an endpoint</a>? Stop that, and start <code>cybermon</code>. Two arguments are
needed: A TCP port number to receive the data on, and a configuration which
tells it what to do. A number of configuration files are bundled in with the
source code, there should be a basic one called <samp>monitor.lua</samp> which
is now installed in the etc directory, depending on where you installed the
software:
</p>
<div class="example">
<pre class="example">cybermon 10000 /usr/local/etc/cyberprobe/monitor.lua
</pre></div>

<p>Now when you generate network traffic, some of the traffic will be presented
in a reasonably intelligent form. For example, I do a naming service lookup
for <code>www.google.com</code>...
</p>
<div class="example">
<pre class="example">host -t a www.slashdot.org
</pre></div>

<a name="index-DNS"></a>

<p>The DNS protocol is parsed, and presented in a human readable form. I can
see the request, and the response:
</p>
<div class="example">
<pre class="example">SNORTc0a80150: 192.168.1.80:54633 -&gt; 192.168.1.1:53. DNS query
    Query: www.slashdot.org

SNORTc0a80150: 192.168.1.1:53 -&gt; 192.168.1.80:54633. DNS response
    Query: www.slashdot.org
    Answer: www.slashdot.org -&gt; 216.34.181.48
</pre></div>

<p>I see the query travelling from my workstation to the broadband router, and
then the response from the broadband router contains an answer field mapping
the name to an address. HTTP protocols are also decoded. Get the Slashdot
home page...
</p>
<div class="example">
<pre class="example">wget -O- 'http://www.slashdot.org/'
</pre></div>

<p>...and amongst all the other stuff, you see the HTTP request and response...
</p>
<div class="example">
<pre class="example">SNORTc0a80150: 192.168.1.80:34284 -&gt; 216.34.181.45:80. HTTP GET request
    URL /
    Connection: Keep-Alive
    User-Agent: Wget/1.14 (linux-gnu)
    Host: slashdot.org
    Accept: */*

SNORTc0a80150: 216.34.181.45:80 -&gt; 192.168.1.80:34284. HTTP response 200
OK
    URL http://slashdot.org/
    Connection: keep-alive
    Content-Length: 113468
    Date: Mon, 26 Aug 2013 13:13:25 GMT
    Age: 17
    X-Varnish: 1493567531 1493567417
    X-XRDS-Location: http://slashdot.org/slashdot.xrds
    Cache-Control: no-cache
    Vary: Accept-Encoding
    SLASH_LOG_DATA: shtml
    Pragma: no-cache
    Content-Type: text/html; charset=utf-8
    Server: Apache/2.2.3 (CentOS)
</pre></div>

<a name="Trying-other-configuration-files"></a>
<h3 class="heading">Trying other configuration files</h3>

<p>In the previous step, you started <code>cybermon</code> with the monitor.lua
configuration file. Have a play with a couple of the others. Configuration
file hexdump.lua produces little hex dumps of things like HTTP bodies:
</p>
<a name="index-hexdump_002elua"></a>

<div class="example">
<pre class="example">cybermon 10000 /usr/local/etc/cyberprobe/hexdump.lua
</pre></div>

<p>Configuration file <samp>dump.lua</samp> causes <code>cybermon</code> to dump the
information to files in the data directory.
</p>
<div class="example">
<pre class="example">mkdir data
cybermon 10000 /usr/local/etc/cyberprobe/dump.lua
</pre></div>

<p>The <samp>quiet.lua</samp> configuration file does nothing. It may be a good place
to start hacking your own configuration file. Which is exactly what we&rsquo;ll do
in the next step.
</p>

<hr>
<a name="Writing-your-own-configuration-file"></a>
<div class="header">
<p>
Next: <a href="#Visualisation" accesskey="n" rel="next">Visualisation</a>, Previous: <a href="#Using-cybermon" accesskey="p" rel="prev">Using <code>cybermon</code></a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Writing-your-own-configuration-file-1"></a>
<h3 class="section">3.6 Writing your own configuration file</h3>

<p>Now, take a copy of the <samp>quiet.lua</samp> configuration file, and have a look
at it. It consists of a bunch of functions written in the LUA language. LUA
is a lightweight scripting langauge which is really good as a configuration
language. For example, this function is called when a TCP connection is
made:
</p>
<a name="index-connection_005fup"></a>
<a name="index-http_005fresponse"></a>

<div class="example">
<pre class="example">observer.connection_up = function(context)
end
</pre></div>

<p>And this function is called when an HTTP response is observed:
</p>
<div class="example">
<pre class="example">observer.http_response = function(context, code, status, header, url,
                                  body)
end
</pre></div>

<p>Let&rsquo;s get hacking! The header parameter is a LUA table which contains
key/value pairs from the header. The url parameter contains the full URL of
the response. The body parameter contains the payload body as an empty
string. Let&rsquo;s start simple:
</p>
<div class="example">
<pre class="example">observer.http_response = function(context, code, status, header, url,
                                  body)
  print(url)
end
</pre></div>

<p>Then run that up...
</p>
<div class="example">
<pre class="example">cybermon 10000 my.lua
</pre></div>

<p>Now, do some web browsing, and you should see a list of URLs flying
past. Each web page typically consists of several HTTP requests, but you
should be able to see the URLs associated with all of the web pages you
visit. Let&rsquo;s tart that up a little more:
</p>
<div class="example">
<pre class="example">-- This function is called when an HTTP response is observed.
observer.http_response = function(context, code, status, header, url,
                                  body)

  -- Take first 40 characters of URL
  local u = url:sub(1,40)

  -- Get Content-Type (first 20 characters)
  local ct
  ct = &quot;&quot;
  for key, value in pairs(header) do
    if key:lower() == &quot;content-type&quot; then
      ct = value:sub(1,20)
    end
  end

  io.write(string.format(&quot;%-40s %-20s %d\n&quot;, u, ct, #body))

end
</pre></div>

<p>That basically outputs three columns: The URL (truncated to 40 characters),
the body content type (truncated to 20 characters) and the HTTP response
payload length. Here&rsquo;s what I get from visiting Slashdot:
</p>
<div class="example">
<pre class="example">http://widget-cdn.rpxnow.com/manifest/sh text/javascript;char 42980
http://slashdot.org/                     text/html; charset=u 40105
http://ad.doubleclick.net/adj/ostg.slash text/javascript; cha 5625
http://pagead2.googlesyndication.com/pag application/x-shockw 33347
http://ad.doubleclick.net/adj/ostg.slash text/javascript; cha 540
http://ad.doubleclick.net/adj/ostg.slash text/javascript; cha 42
http://ad.doubleclick.net/adj/ostg.slash text/javascript; cha 452
http://pagead2.googlesyndication.com/pag                      0
</pre></div>

<a name="Forging-a-TCP-reset"></a>
<h3 class="heading">Forging a TCP reset</h3>

<p>So far, this has just been monitoring. It&rsquo;s time to add data to the network!
From the LUA functions, there are a couple of functions available which
allow you to put some packets back onto the network.
</p>
<a name="index-TCP-reset"></a>
<a name="index-Packet-forgery"></a>
<a name="index-Packet-injection"></a>
<a name="index-cyberprobe_002c-delay-1"></a>
<a name="index-Delay-1"></a>

<p>But first... there&rsquo;s a problem. You remember in step 9, we added a delay?
That&rsquo;s not going to work with packet forgery, because by the time we&rsquo;ve
forged a packet and sent it on to the network, it&rsquo;s too late. So, we need to
change our interface back so that there&rsquo;s no delay on the interface. That
means, we&rsquo;re monitoring network data, but we&rsquo;ll miss the original attack
which triggered a Snort alert.
</p>
<div class="example">
<pre class="example">&lt;interface name=&quot;eth0&quot; delay=&quot;0.0&quot;/&gt;
</pre></div>

<p>Once you have this code working, you might be able to mess with the delay
parameter to see if you can pick a low-latency value that works for you. On
my network, the value 0.02 is low enough to allow a response to allow packet
forgery to work. Any higher, and the forged packets are too late to beat the
real packets.
</p>
<p>The LUA interface passes a context variable to many of the LUA functions,
which gives access to <code>cybermon</code> information and the packet forgery
functions. In this step, we&rsquo;re going to forge a TCP reset on any connections
which are from or to port 80. Hack the configuration file:
</p>
<a name="index-context"></a>

<div class="example">
<pre class="example">observer.connection_up = function(context)

    -- Get TCP ports.
    local cls, src_addr, dest_addr
    cls, src_addr = context:get_src_addr()
    cls, dest_addr = context:get_dest_addr()

    -- check if it is port 80.
    if not((src_addr == &quot;80&quot;) or (dest_addr == &quot;80&quot;)) then
      -- Ignore non-HTTP traffic
      return
    end

    -- TCP reset    
    print(&quot;Reset on HTTP connection.&quot;)
    context:forge_tcp_reset(context)

end
</pre></div>

<p>Now before we go any further, <code>cybermon</code> needs to run as root in
order to use either of the packet forgery functions. Packet forgery needs
access to the raw IP socket layer, which is a privileged operation. Start
that up:
</p>
<div class="example">
<pre class="example">cybermon 10000 my.lua
</pre></div>

<p>Now start web browsing, and you should see a bunch of &quot;Reset on HTTP
connection&quot; messages. Also, you&rsquo;ll see a page saying &quot;The connection was
reset&quot; in your web browser. That&rsquo;s a fairly anti-social configuration to run
on any network. See the <samp>forge-reset.lua</samp> example for a more useful
configuration. It disrupts network traffic going to/from an SSH server which
isn&rsquo;t from your administration workstation.
</p>
<p>On any network with an SSH service open to the outside world, you might want
to use firewall rules to prevent access to the SSH service from addresses
outside of your network, but you could use <code>cybermon</code> as a
belt-and-braces protection mechanism.
</p>
<p>Another example is where you know the user community on your network is
being targeted by phishing emails. Your first step is to try to get the
phishing emails out of their inboxes, getting your email provider to filter
the attacks. But a backup attack would be to make sure your users can&rsquo;t get
to the phisher&rsquo;s web site. The http_request function allows us to reset
requests going to a particular web site.
</p>
<div class="example">
<pre class="example">-- This function is called when an HTTP request is observed.
observer.http_request = function(context, method, url, header, body)

    if header[&quot;Host&quot;] == &quot;example.org&quot; then
      print(&quot;Reset on HTTP request&quot;)
      context:forge_tcp_reset(context)
    end

    if header[&quot;Host&quot;] == &quot;www.example.org&quot; then
      print(&quot;Reset on HTTP request&quot;)
      context:forge_tcp_reset(context)
    end

end
</pre></div>

<a name="Forging-a-DNS-response"></a>
<h3 class="heading">Forging a DNS response</h3>

<a name="index-Forging_002c-DNS-response"></a>

<p>In this step, we&rsquo;ll detect a particular DNS request, and forge a
response. First of all, you&rsquo;ll need to familiarise yourself with host which
is a useful DNS test tool. e.g.
</p>
<div class="example">
<pre class="example">$ host -t a example.org
example.org has address 93.184.216.119
</pre></div>

<p>The <code>example.org</code> name has been resolved to a particular IP
address. Let&rsquo;s hack the DNS request function in my.lua:
</p>
<a name="index-dns_005fmessage"></a>

<div class="example">
<pre class="example">-- This function is called when a DNS message is observed.
observer.dns_message = function(context, header, queries, answers, auth,
                                add)

  -- Check my assumptions.  Need a DNS query request, with one query,
  -- name is example.org, type 'A', class 'IN'.
  if header.qr == 0 and #queries == 1 and
    queries[1].name == &quot;example.org&quot; and queries[1].type == 1 and
    queries[1].class == 1 then

    -- Send a fake response

    -- Set query/response flag to 'response'
    header.qr = 1

    -- 1 answer
    answers = {}
    answers[1] = {}
    answers[1].name = &quot;example.org&quot;
    answers[1].type = 1
    answers[1].class = 1
    answers[1].rdaddress = &quot;1.2.3.4&quot;

    -- 1 answer
    header.ancount = 1

    io.write(&quot;Forging DNS response!\n&quot;)

    context:forge_dns_response(context, header, queries, answers,
                               {}, {})

  end

end
</pre></div>

<p>So, this example, checks that the query is one we want to mess with. If it
is, we turn the query structures into response structures, and hand them
back to <code>cybermon</code> to do a forgery. The above example forges the
address <code>1.2.3.4</code>. Start up <code>cybermon</code> with the script:
</p>
<div class="example">
<pre class="example">cybermon 10000 my.lua
</pre></div>

<p>If everything is working your host command will show a different result:
</p>
<div class="example">
<pre class="example">$ host -t a example.org
example.org has address 1.2.3.4
</pre></div>

<p>DNS forgery has applications in blocking access to a phishers
resources on the internet, you might want to redirect your users to an
address which is inside your network.
</p>
<p>The <a href="#cybermon-configuration"><code>cybermon</code> configuration</a> documentation details the LUA
interface in detail if
you want to find out what else you can do in your LUA code.
</p>

<hr>
<a name="Visualisation"></a>
<div class="header">
<p>
Next: <a href="#Threat-indicators-using-STIX" accesskey="n" rel="next">Threat indicators using STIX</a>, Previous: <a href="#Writing-your-own-configuration-file" accesskey="p" rel="prev">Writing your own configuration file</a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Visualisation-1"></a>
<h3 class="section">3.7 Visualisation</h3>
<a name="index-Visualisation"></a>
<a name="index-ElasticSearch"></a>
<a name="index-Storing-observations"></a>

<p>This is the most incomplete part of <code>Cyberprobe</code>. Look at this part
as demonstrating what might be possible. If you find this interesting, and
feel you could turn this into something more impressive, well... there&rsquo;s a
git check-in with your name on.
</p>
<a name="Storing-observations"></a>
<h3 class="heading">Storing observations</h3>

<p>Now we need somewhere to store the observations which <code>cybermon</code>
discovers. There are many candidates for a storage repository, but my
favourite for this sort of scenario is the excellent ElasticSearch (
<a href="http://www.elasticsearch.org/">http://www.elasticsearch.org/</a>). It is flexible, offers a huge amount
of functionality, and is incredibly simple to interface with, thanks to its
JSON API. So, your next action is to head over to the download page
(<a href="http://www.elasticsearch.org/download/">http://www.elasticsearch.org/download/</a>) and get hold of the latest
version. I&rsquo;m using version 2.3.5 to build this tutorial but the
ElasticSearch API has proven hugely stable, so should work with the latest.
</p>
<p>Having downloaded the latest version, you unpack it, and run it e.g.
</p>
<div class="example">
<pre class="example">tar xvfz elasticsearch-2.3.5.tar.gz
cd elasticsearch-2.3.5
bin/elasticsearch
</pre></div>

<p>One brilliant thing about ElasticSearch is that it needs almost no
configuration to get an instance started. You will need to make one
configuration change to ElasticSearch if there are other instances running
on your network: you need need to change <code>cluster.name</code> to some unique
string in <samp>config/elasticsearch.yml</samp>, otherwise your ElasticSearch
instance might join another cluster on your network, which could complicate
things.
</p>
<p>You can check you have ElasticSearch up and running using a command such as
this:
</p>
<div class="example">
<pre class="example">wget -q -O- http://localhost:9200
</pre></div>

<p>The response will look something like this:
</p>
<a name="index-JSON"></a>

<div class="example">
<pre class="example">{
  &quot;name&quot; : &quot;Ellie Phimster&quot;,
  &quot;cluster_name&quot; : &quot;elasticsearch&quot;,
  &quot;version&quot; : {
    &quot;number&quot; : &quot;2.3.5&quot;,
    &quot;build_hash&quot; : &quot;90f439ff60a3c0f497f91663701e64ccd01edbb4&quot;,
    &quot;build_timestamp&quot; : &quot;2016-07-27T10:36:52Z&quot;,
    &quot;build_snapshot&quot; : false,
    &quot;lucene_version&quot; : &quot;5.5.0&quot;
  },
  &quot;tagline&quot; : &quot;You Know, for Search&quot;
}
</pre></div>

<p>Once ElasticSearch is running, you can get <code>cybermon</code> to load
observations into it by using the <samp>db.lua</samp> configuration file. So if
you&rsquo;re continuing the tutorial, you can stop <code>cybermon</code>, and run:
</p>
<div class="example">
<pre class="example">cybermon 10000 /usr/local/etc/cyberprobe/db.lua
</pre></div>

<p>After some network data has been observed, you should be able to see results
loaded into ElasticSearch using the following command:
</p>
<div class="example">
<pre class="example">curl -s -XPOST \
  &quot;http://localhost:9200/cyberprobe/observation/_search?pretty=true&quot; -d '
{
  &quot;query&quot; : {
    &quot;match_all&quot;: {}
  }
}
'
</pre></div>

<p>You should see some stuff which looks like data scrolling past on the
screen. If your response looks like the following result, that&rsquo;s not so
good, as it means there are no results. See <code>hits.total</code>? Zero means no
results.
</p>
<div class="example">
<pre class="example">{
  &quot;took&quot; : 1,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 5,
    &quot;successful&quot; : 5,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : 0,
    &quot;max_score&quot; : null,
    &quot;hits&quot; : [ ]
  }
}
</pre></div>

<p>If you see a lot of information scrolling past on the screen, that&rsquo;s good.
</p>
<p>The <samp>db.lua</samp> configuration file maps the <code>cybermon</code>
observations into a form which is appropriate to store in
ElasticSearch. Each observation is stored with a 1 hour time-to-live, to
the information is not stored for long.
</p>
<a name="index-Kibana_002c-dashboard"></a>
<a name="index-Dashboard"></a>
<a name="Visualising-observations"></a>
<h3 class="heading">Visualising observations</h3>

<p>Having loaded the observations into ElasticSearch, it&rsquo;s easy to do some
visualisation with Kibana. Kibana is a brilliant, user-configurable
dashboard package designed to sit on ElasticSearch. The dashboard runs in
your browser.
</p>
<p>First thing to do is to download and unpack Kibana. Kibana is managed by the
ElasticSearch people, download page is at
<a href="http://www.elasticsearch.co/downloads/kibana">http://www.elasticsearch.co/downloads/kibana</a>.
</p>
<p>Unpack and execute:
</p>
<div class="example">
<pre class="example">tar xvfz kibana-4.5.4-linux-x64.tar.gz
cd cd kibana-4.5.4-linux-x64
bin/kibana
</pre></div>

<p>Kibana starts on port 5601, so point your browser at e.g.
<a href="http://localhost:5601">http://localhost:5601</a>
</p>
<p>and hopefully you see Kibana&rsquo;s &quot;Welcome to Kibana&quot; screen.  Read the Kibana
tutorial and start playing with the data.
</p>

<hr>
<a name="Threat-indicators-using-STIX"></a>
<div class="header">
<p>
Previous: <a href="#Visualisation" accesskey="p" rel="prev">Visualisation</a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Threat-indicators-using-STIX-1"></a>
<h3 class="section">3.8 Threat indicators using STIX</h3>
<a name="index-STIX"></a>
<a name="index-TAXII"></a>
<a name="index-STIX-indicators"></a>
<a name="index-Threat-indicators"></a>
<a name="index-Cyber-threat-indicators"></a>

<p>We&rsquo;ve been experimenting with an open model for describing cyber
threats. STIX is a community-driven effort to standardise a model for cyber
theat information. TAXII defines a set of services for distributing STIX
information. There&rsquo;s some support in <code>Cyberprobe</code>, but you should
know that this is very prototype at the moment.
</p>
<p>This is what we&rsquo;ve got so far:
</p>
<ul>
<li> There&rsquo;s a simple CSV file format we&rsquo;ve created to describe cyber
threats. This is just for convenience.

</li><li> <a name="index-stix_002dcreate"></a>
A script, <code>stix-create</code> which reads the above configuration file,
and converts into a STIX document containing Indicator objects.

</li><li> <a name="index-taxii_002dserver"></a>
A script, <code>taxii-server</code> which acts as a very simple TAXII server,
serving up STIX documents.

</li><li> <a name="index-taxii_002dclient"></a>
A script, <code>taxii-client</code> which connects to a TAXII server, gets STIX
documents and dumps some stuff out.

</li><li> <a name="index-taxii_002dsync_002djson"></a>
A script <code>taxii-sync-json</code> which connects to a TAXII server, gets
STIX documents, massages the whole lot into a single JSON form, and dumps
that to a file.  This is intended to be used with the
<samp>stix+db.lua</samp> and <samp>stix+alert.lua</samp> configuration files.

</li><li> A configuration file for <code>cybermon</code> which reads the JSON threat
information and reports when theats are observed.

</li></ul>

<a name="index-pyOpenSSL"></a>
<a name="index-libtaxii-1"></a>
<a name="index-stix-1"></a>
<a name="index-pip"></a>

<p>Before taking this any further, you need to have Python installed, along
with various dependencies (<code>pyOpenSSL</code>, <code>libtaxii</code> and
<code>stix</code>). The easiest way to install the dependencies is to install
<code>pip</code>, and issue this command:
</p>
<div class="example">
<pre class="example">sudo pip install libtaxii pyOpenSSL stix
</pre></div>

<a name="A-STIX-document-service"></a>
<h3 class="heading">A STIX document service</h3>

<p>The installation bundle includes a couple of CSV files containing some
fictional cyber theats. Search for <samp>example1.txt</samp> and
<samp>example2.txt</samp>. They may be in <samp>/usr/local/share/doc/cyberprobe</samp>
once you&rsquo;ve installed everything. You need to create a data area, and
convert these files into STIX ready for serving:
</p>
<div class="example">
<pre class="example">mkdir /tmp/stix
cd /tmp/stix
mkdir -p data/default
stix-create /usr/local/share/doc/cyberprobe/example1.txt \
        data/default/1 -i ex:1
stix-create /usr/local/share/doc/cyberprobe/example2.txt \
        data/default/2 -i ex:2
</pre></div>

<p>Check that you have two new XML files in data/default directory. If they&rsquo;re
there, you&rsquo;re ready to start a STIX server. This will run on port 8080, so
you&rsquo;ll need to use a different port number if you don&rsquo;t like this one. It&rsquo;s
important that this is run from the directory where you just created the
data directory.
</p>
<div class="example">
<pre class="example">taxii-server --port 8080
</pre></div>

<p>If that works, use the test client to communicate:
</p>
<div class="example">
<pre class="example">taxii-client --port 8080
</pre></div>

<p>And you should see some stuff that looks like cyber threat information
dumped on the screen.
</p>
<a name="Deploying-theat-information-to-cybermon"></a>
<h3 class="heading">Deploying theat information to <code>cybermon</code></h3>

<p>Now, we use <code>taxii-sync-json</code> to fetch the STIX information in a
JSON form I can easily ingest into the LUA code:
</p>
<div class="example">
<pre class="example">taxii-sync-json --port 8080
</pre></div>

<p>This should create a JSON file called <samp>stix-default-combined.json</samp>.
</p>
<p>Finally, stop any running <code>cybermon</code> processes, and run
<code>cybermon</code> with a configuration file which reads the JSON file.
</p>
<a name="index-stix_002balert_002elua"></a>

<a name="index-stix_002balert_002elua-configuration-file"></a>
<a name="index-cybermon_002c-stix_002balert_002elua-configuration-file"></a>

<div class="example">
<pre class="example">cybermon 10000 /usr/local/etc/cyberprobe/stix+alert.lua
</pre></div>

<p>Now, this produces no output, except when activity which hits on a cyber
threat is observed. If you used my sample data, then this activity should
trigger a theat:
</p>
<div class="example">
<pre class="example">wget -q -O- http://www.malware.com/malware.dat
</pre></div>

<p>I should just say at this point, I have no idea if the <code>malware.com</code>
site is dodgy or not, it just seems to redirect to Wikipedia. Hope they
don&rsquo;t mind us using them for this test.
</p>
<p>If this works, you should see the following output:
</p>
<div class="example">
<pre class="example">DNS query for www.malware.com, hits example1:5 (Hostname of malware
server)!
DNS query for www.malware.com, hits example1:5 (Hostname of malware
 server)!
DNS response for www.malware.com, hits example1:5 (Hostname of malware
 server)!
DNS response for www.malware.com, hits example1:5 (Hostname of malware
 server)!
HTTP request to http://www.malware.com/malware.dat, hits example1:7 (URL
 of a page serving malware)!
HTTP request to www.malware.com, hits example1:5 (Hostname of malware
 server)!
HTTP response from http://www.malware.com/malware.dat, hits example1:7
 (URL of a page serving malware)!
</pre></div>

<p>This hits on a number of theat indicators. The hostname www.malware.com is
present in a theat indicator, and it is detected in the HTTP request, and
both the DNS query and response. Also, the URL
<code>http://www.malware.com/malware.dat</code> is in a threat indicator and it is
detected in both the HTTP request and response.
</p>
<a name="index-stix_002balert_002elua-configuration-file-1"></a>
<a name="index-cybermon_002c-stix_002balert_002elua-configuration-file-1"></a>
<p>The <samp>stix+alert.lua</samp> configuration file updates its configuration if
the JSON configuration file has changed. So, you can do a round-trip update
by changing the input files, re-running stix-create, using
<code>taxii-sync-json</code> to fetch the updates, and all without stopping the
monitoring.
</p>
<a name="index-stix_002bdb_002elua-configuration-file"></a>
<a name="index-cybermon_002c-stix_002bdb_002elua-configuration-file"></a>

<p>The <samp>stix+db.lua</samp> configuration file generates ElasticSearch events as
<samp>db.lua</samp> does, but it also adds indicator detection information to
the events. If you use <samp>stix+db.lua</samp>, with the Kibana dashboard, the
&quot;Indications&quot; table on the right hand side of the dashboard will show
detected indicators.
</p>
<a name="Conclusion"></a>
<h3 class="heading">Conclusion</h3>

<p>All done, I hope you enjoyed the tutorial! Any comments on the software, or
tutorial itself are very welcome! Positive, or negative, we want to hear how
you found the experience.
</p>

<hr>
<a name="Running-cyberprobe_002fcybermon"></a>
<div class="header">
<p>
Next: <a href="#The-pub_002fsub-infrastructure" accesskey="n" rel="next">The pub/sub infrastructure</a>, Previous: <a href="#Quick-start-tutorial" accesskey="p" rel="prev">Quick start tutorial</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Running-cyberprobe_002fcybermon-1"></a>
<h2 class="chapter">4 Running cyberprobe/cybermon</h2>

<p>The <code>cyberprobe</code> and <code>cybermon</code> utilities are used as a pair
to analyse network data.  The <code>cyberprobe</code> component is used to
capture data and forward to <code>cybermon</code>.  When running on a network,
you can decide to run several <code>cyberprobe</code> deployments into a single
<code>cybermon</code>.  Or run a <code>cybermon</code> process everywhere you
run a <code>cyberprobe</code>.
</p>
<p>Once you have decided your checklist, your setup checklist for using
<code>cyberprobe</code> and <code>cybermon</code> consists of:
</p>
<ul>
<li> Install the software, see <a href="#Obtaining-the-software">Obtaining the software</a>.

</li><li> If you are going to run <code>cyberprobe</code>, provide the appropriate
configuration
in file
<samp>/usr/local/etc/cyberprobe.cfg</samp>.  The standard installation
will install a template at this location.
See <a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a> on managing this configuration
file.
Make sure that the configuration file includes the delivery address of the
appropriate <code>cybermon</code>.

</li><li> <a name="index-cybermon_002c-pub_002fsub"></a>
<a name="index-Pub_002fsub-delivery"></a>
If you are going to run <code>cybermon</code>, provide the
appropriate configuration in file
<samp>/usr/local/etc/cyberprobe/cybermon.lua</samp>.  The standard installation
does not create a file at this location, and you should create one.  You can
copy an example from the <samp>/usr/local/etc/cyberprobe</samp> directory.
Use <samp>/usr/local/etc/cyberprobe/zeromq.lua</samp> if you want to use
pub/sub delivery.  See <a href="#cybermon-configuration"><code>cybermon</code> configuration</a> for more
information on constructing the configuration file.
See <a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a> for descriptions of the
example configuration files.

</li><li> The installation installs appropriate <code>systemd</code> configuration, and
you can enable boot-time starting of <code>cyberprobe</code> or
<code>cybermon</code> by using either or both of these commands:
<div class="example">
<pre class="example">systemctl enable cyberprobe
systemctl enable cybermon
</pre></div>
<p>Once enabled, you can reboot, or immediately start the processes using either
or both of these commands:
</p><div class="example">
<pre class="example">systemctl start cyberprobe
systemctl start cybermon
</pre></div>

</li></ul>


<hr>
<a name="The-pub_002fsub-infrastructure"></a>
<div class="header">
<p>
Next: <a href="#Reference" accesskey="n" rel="next">Reference</a>, Previous: <a href="#Running-cyberprobe_002fcybermon" accesskey="p" rel="prev">Running cyberprobe/cybermon</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-pub_002fsub-infrastructure-1"></a>
<h2 class="chapter">5 The pub/sub infrastructure</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Pub_002fsub-overview" accesskey="1">Pub/sub overview</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-Cassandra-subscriber" accesskey="2">The Cassandra subscriber</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-ElasticSearch-subscriber" accesskey="3">The ElasticSearch subscriber</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-Gaffer-subscriber" accesskey="4">The Gaffer subscriber</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-Google-BigQuery-subscriber" accesskey="5">The Google BigQuery subscriber</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-debug-monitor-subscriber" accesskey="6">The debug monitor subscriber</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>


<hr>
<a name="Pub_002fsub-overview"></a>
<div class="header">
<p>
Next: <a href="#The-Cassandra-subscriber" accesskey="n" rel="next">The Cassandra subscriber</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Pub_002fsub-overview-1"></a>
<h3 class="section">5.1 Pub/sub overview</h3>

<a name="index-cybermon_002c-pub_002fsub-1"></a>
<a name="index-Pub_002fsub-delivery-1"></a>

<p>Events from <code>cybermon</code> can be delivered to a pub/sub mechanism which
allows subscribers to connect and disconnect without disrupting delivery
to other subscribers.  The pub/sub mechanism used is ZeroMQ, which is a
simple non-persistent, broker-less mechanism.
</p>
<p>In order to use this mechanism, you need to ensure you have configured
<code>cybermon</code> appropriately.  This is normally done by copying the
configuration file at <samp>/usr/local/etc/cyberprobe/zeromq.lua</samp>
to <samp>/usr/local/etc/cyberprobe/cybermon.lua</samp> prior to executing
<code>cybermon</code>.  Once running, <code>cybermon</code> will publish all events
to it&rsquo;s publisher port on TCP port 5555.
</p>
<p>ZeroMQ allows subscribers to be started and stopped without affecting the
delivery of events to other receivers.  That is, you can start
<code>cybermon</code> with no subscribers, discarding data, and introduce
subscribers later.
</p>

<hr>
<a name="The-Cassandra-subscriber"></a>
<div class="header">
<p>
Next: <a href="#The-ElasticSearch-subscriber" accesskey="n" rel="next">The ElasticSearch subscriber</a>, Previous: <a href="#Pub_002fsub-overview" accesskey="p" rel="prev">Pub/sub overview</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-Cassandra-subscriber-1"></a>
<h3 class="section">5.2 The Cassandra subscriber</h3>

<a name="index-cybermon_002dcassandra_002c-invocation"></a>
<a name="index-Cassandra"></a>
<a name="index-Apache-Cassandra"></a>
<a name="index-Graph-store"></a>

<p>This subscriber writes data to a Cassandra store in a schema useful for
graph analysis.
</p>
<p>The schema is experimental, but see
<a href="https://github.com/cybermaggedon/cassandra-redland">https://github.com/cybermaggedon/cassandra-redland</a> for the tooling
I&rsquo;m using.
</p>
<p>On the command-line you need to tell the subscriber the location
of the Cassandra contact points e.g.
</p>
<div class="example">
<pre class="example">cybermon-cassandra tcp://localhost:5555 cas1,cas2,cas3
</pre></div>

<p>See <a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a>.
</p>


<hr>
<a name="The-ElasticSearch-subscriber"></a>
<div class="header">
<p>
Next: <a href="#The-Gaffer-subscriber" accesskey="n" rel="next">The Gaffer subscriber</a>, Previous: <a href="#The-Cassandra-subscriber" accesskey="p" rel="prev">The Cassandra subscriber</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-ElasticSearch-subscriber-1"></a>
<h3 class="section">5.3 The ElasticSearch subscriber</h3>

<a name="index-cybermon_002delasticsearch_002c-invocation"></a>
<a name="index-ElasticSearch-1"></a>

<p>This suscriber extracts events from pub/sub and formats them for delivery
to ElasticSearch.  The only piece of information you need is the ElasticSearch
base URI, which is used as a command-line parameter e.g.
</p>
<div class="example">
<pre class="example">cybermon-elasticsearch tcp://localhost:5555 http://es-host1:9200
</pre></div>

<p>See <a href="#cybermon_002delasticsearch-invocation"><code>cybermon-elasticsearch</code> invocation</a>.
</p>

<hr>
<a name="The-Gaffer-subscriber"></a>
<div class="header">
<p>
Next: <a href="#The-Google-BigQuery-subscriber" accesskey="n" rel="next">The Google BigQuery subscriber</a>, Previous: <a href="#The-ElasticSearch-subscriber" accesskey="p" rel="prev">The ElasticSearch subscriber</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-Gaffer-subscriber-1"></a>
<h3 class="section">5.4 The Gaffer subscriber</h3>

<a name="index-cybermon_002dgaffer_002c-invocation"></a>
<a name="index-Gaffer"></a>
<a name="index-Graph-store-1"></a>

<p>Gaffer is an experimental graph database built on top of Accumulo, Zookeeper
and Hadoop.  This subscriber writes data to Gaffer in a form intended to
be used for querying with SPARQL.
</p>
<p>Documentation on Gaffer is sparse.  If you want to use this, you will need
to get familiar with some of my tooling at
<a href="https://github.com/cybermaggedon/gaffer-tools">https://github.com/cybermaggedon/gaffer-tools</a>.  To get started,
you may also want to use my stand-alone Docker container at
<a href="https://hub.docker.com/r/cybermaggedon/gaffer/">https://hub.docker.com/r/cybermaggedon/gaffer/</a>.
</p>
<p>On the command-line you need to tell the subscriber the location
of the Gaffer REST API. e.g.
</p>
<div class="example">
<pre class="example">cybermon-elasticsearch tcp://localhost:5555 http://gaffer-host1:8080/example-rest/v1
</pre></div>

<p>See <a href="#cybermon_002dgaffer-invocation"><code>cybermon-gaffer</code> invocation</a>.
</p>

<hr>
<a name="The-Google-BigQuery-subscriber"></a>
<div class="header">
<p>
Next: <a href="#The-debug-monitor-subscriber" accesskey="n" rel="next">The debug monitor subscriber</a>, Previous: <a href="#The-Gaffer-subscriber" accesskey="p" rel="prev">The Gaffer subscriber</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-Google-BigQuery-subscriber-1"></a>
<h3 class="section">5.5 The Google BigQuery subscriber</h3>

<a name="index-cybermon_002dbigquery_002c-invocation"></a>
<a name="index-Google-BigQuery"></a>
<a name="index-Google-Cloud-Platform"></a>

<p>Google BigQuery is a cloud data storage mechanism which is part of the
Google Cloud Platform, available to Google Cloud subscribers.
</p>
<p>BigQuery is a &rsquo;big data&rsquo; relational style database, with a query language
familiar to SQL users.
</p>
<p>To use BigQuery, you need to get a private key file in private JSON format
from the cloud interface, and store this at
<samp>/usr/local/etc/cyberprobe/private.json</samp>.  One way to do this is
to go to the IAM interface and create a use with BigQuery access, and download
the private JSON file.
</p>
<p>You need to also to create the BigQuery dataset.  Call it &lsquo;<samp>cyberprobe</samp>&rsquo;.
The BigQuery table is created automatically when the subscriber is started.
</p>
<p>If the key is installed at the above location, you do not need to
provide any further parameters on the command line.  Just run:
</p>
<div class="example">
<pre class="example">cybermon-bigquery
</pre></div>

<blockquote>
<p><b>Note:</b> FIXME: Document the schema.  The easiest way to see the schema is to use
this subscriber, and view the schema in the Google BigQuery interface.
</p></blockquote>

<p>See <a href="#cybermon_002dbigquery-invocation"><code>cybermon-bigquery</code> invocation</a>.
</p>

<hr>
<a name="The-debug-monitor-subscriber"></a>
<div class="header">
<p>
Previous: <a href="#The-Google-BigQuery-subscriber" accesskey="p" rel="prev">The Google BigQuery subscriber</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-debug-monitor-subscriber-1"></a>
<h3 class="section">5.6 The debug monitor subscriber</h3>

<a name="index-cybermon_002dmonitor_002c-invocation"></a>

<p>The <code>cybermon-monitor</code> subscriber is a subscriber which takes
events and writes human-readable output on standard output.  This is a
useful means to verify that <code>cyberprobe</code>, <code>cybermon</code> and
pub/sub are configured correctly.
</p>
<p>See <a href="#cybermon_002dmonitor-invocation"><code>cybermon-monitor</code> invocation</a>.
</p>

<hr>
<a name="Reference"></a>
<div class="header">
<p>
Next: <a href="#Architecture" accesskey="n" rel="next">Architecture</a>, Previous: <a href="#The-pub_002fsub-infrastructure" accesskey="p" rel="prev">The pub/sub infrastructure</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Reference-1"></a>
<h2 class="chapter">6 Reference</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#cyberprobe-invocation" accesskey="1"><code>cyberprobe</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cyberprobe-configuration" accesskey="2"><code>cyberprobe</code> configuration</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cyberprobe_002dcli-invocation" accesskey="3"><code>cyberprobe-cli</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cyberprobe_002dcli-commands" accesskey="4"><code>cyberprobe-cli</code> commands</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Output-streaming-protocols" accesskey="5">Output streaming protocols</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Management-protocol" accesskey="6">Management protocol</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon-invocation" accesskey="7"><code>cybermon</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon-configuration" accesskey="8"><code>cybermon</code> configuration</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon-example-configurations" accesskey="9"><code>cybermon</code> example configurations</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Cybermon-ZeroMQ-message-format">Cybermon ZeroMQ message format</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002dmonitor-invocation"><code>cybermon-monitor</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002delasticsearch-invocation"><code>cybermon-elasticsearch</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002dbigquery-invocation"><code>cybermon-bigquery</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002dgaffer-invocation"><code>cybermon-gaffer</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#taxii_002dclient-invocation"><code>taxii-client</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#taxii_002dsync_002djson-invocation"><code>taxii-sync-json</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#taxii_002dserver-invocation"><code>taxii-server</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#nhis11_002drcvr-invocation"><code>nhis11-rcvr</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#etsi_002drcvr-invocation"><code>etsi-rcvr</code> invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#ElasticSearch-model">ElasticSearch model</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>


<hr>
<a name="cyberprobe-invocation"></a>
<div class="header">
<p>
Next: <a href="#cyberprobe-configuration" accesskey="n" rel="next"><code>cyberprobe</code> configuration</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cyberprobe-invocation-1"></a>
<h3 class="section">6.1 <code>cyberprobe</code> invocation</h3>

<a name="index-cyberprobe_002c-invocation"></a>

<p><code>cyberprobe</code> is a network monitor which collects packets which match an
IP address list.  The packets collected are streamed using network streaming
protocols.  The IP address match list can be statically conqfigured (in a
configuration file), can be dynamically changed using a management
interface, or can be dynamically changed as a result of snort alerts.
Synopsis:
</p>
<div class="example">
<pre class="example">cyberprobe <var>configuration-file</var>
</pre></div>

<ul>
<li> <var>configuration-file</var> is the name of an XML configuration file. 
See <a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a>.

</li></ul>

<a name="index-cyberprobe_002c-configuration"></a>

<p><code>cyberprobe</code> executes indefinitely - to end the program, a signal should
be sent. e.g.
</p>
<div class="example">
<pre class="example">killall cyberprobe
</pre></div>


<hr>
<a name="cyberprobe-configuration"></a>
<div class="header">
<p>
Next: <a href="#cyberprobe_002dcli-invocation" accesskey="n" rel="next"><code>cyberprobe-cli</code> invocation</a>, Previous: <a href="#cyberprobe-invocation" accesskey="p" rel="prev"><code>cyberprobe</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cyberprobe-configuration-1"></a>
<h3 class="section">6.2 <code>cyberprobe</code> configuration</h3>
<a name="index-cyberprobe_002c-configuration-1"></a>
<a name="index-cyberprobe_002c-control"></a>
<a name="index-cyberprobe_002c-interfaces"></a>
<a name="index-cyberprobe_002c-targets"></a>
<a name="index-cyberprobe_002c-endpoints"></a>
<a name="index-cyberprobe_002c-snort_005falert"></a>
<a name="index-control"></a>
<a name="index-interfaces"></a>
<a name="index-targets"></a>
<a name="index-endpoints"></a>
<a name="index-snort_005falert"></a>
<a name="index-IP-address-matching"></a>
<a name="index-IP-address-mask"></a>
<a name="index-targets_002c-address-mask"></a>

<p>The configuration file is re-read when it changes, and changes are
immediately actioned.
</p>
<p>Sample configuration:
</p>
<div class="example">
<pre class="example">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;

&lt;configuration&gt;

  &lt;!-- Start a control interface on port 8888. --&gt;
  &lt;control port=&quot;8888&quot; username=&quot;admin&quot; password=&quot;horse_battery_staple&quot;&gt;

  &lt;!-- Set of interfaces to use for collection. --&gt;
  &lt;interfaces&gt;

    &lt;!-- filter element is optional.  Can be used to make sure you don't
         sniff the outbound streams. --&gt;
    &lt;interface name=&quot;eth0&quot; filter=&quot;not port 10001 and not port 10002&quot;/&gt;

    &lt;-- The delay attribute can be used to specify a delay before
           packets are processed.  In seconds. --&gt; 
    &lt;interface name=&quot;eth1&quot; delay=&quot;0.5&quot;/&gt;

  &lt;/interfaces&gt;

  &lt;!-- Statically targeted addresses. --&gt;
  &lt;targets&gt;
    &lt;target address=&quot;192.168.1.1&quot; liid=&quot;123456&quot;/&gt;
    &lt;target address=&quot;192.168.1.2&quot; liid=&quot;123981&quot;/&gt;
    &lt;target address=&quot;10.2.0.0/16&quot; liid=&quot;9123780&quot;/&gt;
    &lt;target address=&quot;10.1.1.1&quot; liid=&quot;9123780&quot;/&gt;
    &lt;target address=&quot;10.1.1.1&quot; liid=&quot;9123780&quot;/&gt;
    &lt;target address=&quot;10.1.1.0&quot; liid=&quot;591875&quot;/&gt;
    &lt;target address=&quot;10.1.1.2&quot; liid=&quot;492895&quot;/&gt;
    &lt;target address=&quot;10.1.1.3&quot; liid=&quot;591875&quot;/&gt;
    &lt;target address=&quot;10.1.1.4&quot; liid=&quot;591875&quot;/&gt;
    &lt;target address=&quot;10.1.1.5&quot; liid=&quot;591875&quot;/&gt;
    &lt;target address=&quot;10.1.1.6&quot; liid=&quot;591875&quot;/&gt;
    &lt;target address=&quot;10.1.1.7&quot; liid=&quot;591875&quot;/&gt;
    &lt;target address=&quot;10.1.1.8&quot; liid=&quot;591875&quot;/&gt;
    &lt;target address=&quot;10.1.1.9&quot; liid=&quot;591875&quot;/&gt;
    &lt;target address=&quot;10.1.1.10&quot; liid=&quot;591875&quot;/&gt;
    &lt;target address=&quot;aaaa:bbbb:cccc:dddd::4:5:6&quot;
      class=&quot;ipv6&quot; liid=&quot;983898&quot;/&gt;
    &lt;target address=&quot;aaaa:bbbb:cccc::/48&quot;
      class=&quot;ipv6&quot; liid=&quot;983800&quot;/&gt;
  &lt;/targets&gt;

  &lt;!-- Endpoints for delivery of collected packets. --&gt;
  &lt;endpoints&gt;

    &lt;!-- Send collected packets to monitor1:10001 in NHIS 1.1
         stream. --&gt;
    &lt;endpoint hostname=&quot;monitor1&quot; port=&quot;10001&quot; transport=&quot;tcp&quot; type=&quot;nhis1.1&quot;/&gt;

    &lt;!-- Send collected packets to monitor2:10002 in ETSI LI
         stream. --&gt;
    &lt;endpoint hostname=&quot;monitor2&quot; port=&quot;10002&quot; transport=&quot;tcp&quot; type=&quot;etsi&quot;/&gt;

  &lt;/endpoints&gt;

  &lt;!-- Set of parameters, primarily used to configure the metadata in
       ETSI LI metadata. --&gt;
  &lt;parameters&gt;

    &lt;!-- Value used for deliveryCountryCode and authorizationCountryCode
         in LI PS PDU. Should be 2-character string. --&gt;
    &lt;parameter key=&quot;country&quot; value=&quot;DE&quot;/&gt;

    &lt;!-- Value used for operatorIdentifier in LI PS PDU. A string up to
         16 characters. --&gt;
    &lt;parameter key=&quot;operator&quot; value=&quot;Cyber&quot;/&gt;

    &lt;!-- Value used for networkElementIdentifier in LI PS PDU. String up
         to 16 characters in length. --&gt;
    &lt;parameter key=&quot;network_element&quot; value=&quot;10.8.2.4&quot;/&gt;

    &lt;!-- Value used for interceptionPointID in LI PS PDU. String up
         to 8 characters in length. --&gt;
    &lt;parameter key=&quot;interception_point&quot; value=&quot;abcd1234&quot;/&gt;

    &lt;!-- Username values used in IPIRI connection.  Key form is
         &quot;username.&quot; plus the LIID --&gt;
    &lt;parameter key=&quot;username.123456&quot; value=&quot;user01@example.org&quot;/&gt;
    &lt;parameter key=&quot;username.123981&quot; value=&quot;user02@example.org&quot;/&gt;
    &lt;parameter key=&quot;username.981235&quot; value=&quot;user03@example.org&quot;/&gt;

    &lt;!-- Parameters in this form are used select the LIID which is used
         when packets are collected on Snort alerts.  Basically, this
         maps the Snort signature ID to a LIID. --&gt;
    &lt;parameter key=&quot;snort.1.liid&quot; value=&quot;SNORT1&quot;/&gt;
    &lt;parameter key=&quot;snort.2.liid&quot; value=&quot;SNORT2&quot;/&gt;

   &lt;/parameters&gt;

   &lt;!-- Optional element.  Listens for Snort alerts, and dynamically
        targets addresses for 60 seconds. --&gt;
   &lt;!--
   &lt;snort_alert socket=&quot;/var/log/snort/snort_alert&quot; duration=&quot;60&quot;/&gt;
   --&gt;

&lt;/configuration&gt;
</pre></div>

<p>The <code>control</code> element is optional, if it exists, <code>cyberprobe</code> runs
a management interface on the specified port. The <code>port</code>,
<code>username</code> and <code>password</code> attributes must be specified. See
<a href="#Management-interface">Management interface</a> for how to communicate with that interface.
</p>
<p>The <code>interfaces</code> block defines a set of interfaces to sniff. The
<code>name</code> attribute is mandatory, the <code>filter</code> element is optional,
and if specified should describe a BPF (Berkley Packet Filter)
expression. The <code>delay</code> element can be used to specify, in seconds, the
duration to wait before packets are processed. The delay is specified as a
floating point decimal.
</p>
<p>The <code>targets</code> block defines IP address to match. The
<code>address</code> attribute defines the IP address with optional mask used for
the address match. If a mask is specified, this describes the subset of the
address which will be used for matching.  For instance, if
<code>192.168.0.0/16</code> is specified, then a 16-bit mask will be applied, which
makes this a class-B address match.  That is, any address in the
<code>192.168.0.0</code>-<code>192.168.255.255</code> range will match.
If no mask is specified, then this is an exact match against a single address.
The <code>liid</code> attribute defines the LIID which will be applied
if this
particular IP address is detected. The address must be an IP address, and
not a hostname. The address can be an IPv6 address if the <code>class</code>
attribute is included, and set to <code>ipv6</code>.
</p>
<p>LIIDs can occur in multiple places in the target block, but an IP address
should only occur once in the target block.
</p>
<a name="index-certificate_002c-cyberprobe-configuration-option"></a>
<a name="index-key_002c-cyberprobe-configuration-option"></a>
<a name="index-trusted_002dca_002c-cyberprobe-configuration-option"></a>
<a name="index-TLS"></a>
<a name="index-SSL"></a>
<a name="index-cyberprobe-secure-delivery"></a>
<p>The <code>endpoints</code> block defines a set of addresses for delivery. The
<code>hostname</code> and <code>port</code> attributes should be used to describe the
endpoint address. Type <code>type</code> attribute should be <code>nhis1.1</code> or
<code>etsi</code> to specify which output stream format to use.  The <code>transport</code>
describe the transport type, which should be <code>tcp</code> for standard TCP stream,
or <code>tls</code> for an SSL/TLS stream.  If TLS is invoked, the attributes
<code>certificate</code>, <code>key</code> and <code>trusted-ca</code> should be specified,
with filenames for client certificate, private key, and a trust CA chain.
These should all be in PEM format.
</p>

<p>The optional <code>parameters</code> block defines a set of parameters which are
only used in ETSI delivery. Each parameter element should have a <code>key</code>
and a <code>value</code> attribute. The parameter values for <code>country</code>,
<code>operator</code>, <code>network_element</code> and <code>interception_point</code>
describe values which are used in the <code>PSHeader</code> and <code>IRI</code>
constructs. The parameters with prefix <code>username.</code> describe values for
the <code>username</code> values in the IPIRI construct in ETSI LI. The <code>key</code>
value is the literal <code>username.</code> suffixed with the LIID. If such an
entry is present, it is used for the <code>username</code>. All parameters are
optional, meaningless defaults (e.g. unknown) will be used if not specified.
</p>

<hr>
<a name="cyberprobe_002dcli-invocation"></a>
<div class="header">
<p>
Next: <a href="#cyberprobe_002dcli-commands" accesskey="n" rel="next"><code>cyberprobe-cli</code> commands</a>, Previous: <a href="#cyberprobe-configuration" accesskey="p" rel="prev"><code>cyberprobe</code> configuration</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cyberprobe_002dcli-invocation-1"></a>
<h3 class="section">6.3 <code>cyberprobe-cli</code> invocation</h3>

<a name="index-cyberprobe_002dcli_002c-invocation"></a>
<a name="index-Management-client"></a>

<p><code>cyberprobe-cli</code> connects to <code>cyberprobe</code> on the
management port to allow dynamic administration.  This permits
dynamic management of resources.
</p>
<blockquote>
<p><b>Note:</b> You can end up in a confusing situation if you use both the configuration
file, and the management interface to configure resources.  It is best to
use one or the other.  You can safely use the configuration file
for resources that you don&rsquo;t intend to change through the management interface,
but you shouldn&rsquo;t use both the configuration file and management interface
to change the same resources.
</p></blockquote>

<p>Synopsis:
</p>
<div class="example">
<pre class="example">cyberprobe-cli HOST PORT
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cyberprobe-cli vpn-host031 8888
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>HOST</samp>&rsquo;</dt>
<dd><p>Specifies the hostname or  IP address of the host to connect to.
</p>
</dd>
<dt>&lsquo;<samp>PORT</samp>&rsquo;</dt>
<dd><p>Specifies the management port number.
</p>
</dd>
</dl>

<p>Upon connection, you are prompted to enter a username and password.  Upon
successful authentication, you are then offered a command line prompt for
administration commands.
</p>

<hr>
<a name="cyberprobe_002dcli-commands"></a>
<div class="header">
<p>
Next: <a href="#Output-streaming-protocols" accesskey="n" rel="next">Output streaming protocols</a>, Previous: <a href="#cyberprobe_002dcli-invocation" accesskey="p" rel="prev"><code>cyberprobe-cli</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cyberprobe_002dcli-commands-1"></a>
<h3 class="section">6.4 <code>cyberprobe-cli</code> commands</h3>

<a name="index-cyberprobe_002dcli_002c-commands"></a>
<a name="index-Management-client-1"></a>

<p>The following commands are supported by <code>cyberprobe-cli</code>:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>add endpoint HOST PORT TYPE TRANSPORT</samp>&rsquo;</dt>
<dd><p>Adds a delivery endpoint.
</p><dl compact="compact">
<dt>&lsquo;<samp>HOST</samp>&rsquo;</dt>
<dd><p>Specifies the delivery host.
</p></dd>
<dt>&lsquo;<samp>PORT</samp>&rsquo;</dt>
<dd><p>Specifies TCP port to deliver to.
</p></dd>
<dt>&lsquo;<samp>TYPE</samp>&rsquo;</dt>
<dd><p>Can be one of &lsquo;<samp>nhis</samp>&rsquo; or &lsquo;<samp>etsi</samp>&rsquo; for delivery protocol.
</p></dd>
<dt>&lsquo;<samp>TRANSPORT</samp>&rsquo;</dt>
<dd><p>Can be one of &lsquo;<samp>tcp</samp>&rsquo; or &lsquo;<samp>tls</samp>&rsquo; for TCP or TLS transports.
</p></dd>
</dl>

<p>Note: It is not possible to specify the appropriate transport paramters for
TLS delivery using the management interface currently.  (FIXME).
</p>
</dd>
<dt>&lsquo;<samp>add interface INTERFACE DELAY [FILTER]</samp>&rsquo;</dt>
<dd><p>Adds an interface for packet sniffing.
</p><dl compact="compact">
<dt>&lsquo;<samp>INTERFACE</samp>&rsquo;</dt>
<dd><p>Interface name.
</p></dd>
<dt>&lsquo;<samp>DELAY</samp>&rsquo;</dt>
<dd><p>Delay between packet acquisiton and delivery.  Defaults to zero.
</p></dd>
<dt>&lsquo;<samp>FILTER</samp>&rsquo;</dt>
<dd><p>Optional, species a filter to be applied for positive selection of packets,
in BPF / libpcap format.
</p></dd>
</dl>

</dd>
<dt>&lsquo;<samp>add parameter KEY VALUE</samp>&rsquo;</dt>
<dd><p>Adds a parameter.
</p><dl compact="compact">
<dt>&lsquo;<samp>KEY</samp>&rsquo;</dt>
<dd><p>Parameter key.
</p></dd>
<dt>&lsquo;<samp>VALUE</samp>&rsquo;</dt>
<dd><p>Parameter value.
</p></dd>
</dl>

</dd>
<dt>&lsquo;<samp>add target LIID PROTOCOL ADDRESS</samp>&rsquo;</dt>
<dd><p>Adds an address target for packet capture.
</p><dl compact="compact">
<dt>&lsquo;<samp>LIID</samp>&rsquo;</dt>
<dd><p>LIID / device identifier.
</p></dd>
<dt>&lsquo;<samp>PROTOCOL</samp>&rsquo;</dt>
<dd><p>Address protocol, one of &lsquo;<samp>ip4</samp>&rsquo; or &lsquo;<samp>ip6</samp>&rsquo;.
</p></dd>
<dt>&lsquo;<samp>ADDRESS</samp>&rsquo;</dt>
<dd><p>Address value, in IPv4 or IPv6 format, according to the PROTOCOL value.
</p></dd>
</dl>

</dd>
<dt>&lsquo;<samp>help</samp>&rsquo;</dt>
<dd><p>Displays help (not implemented).
</p>
</dd>
<dt>&lsquo;<samp>quit</samp>&rsquo;</dt>
<dd><p>Causes the client to close the connection and terminate.
</p>
</dd>
<dt>&lsquo;<samp>remove endpoint HOST PORT TYPE TRANSPORT</samp>&rsquo;</dt>
<dd><p>Removes an endpoint added through the &lsquo;<samp>add endpoint</samp>&rsquo; command.
The HOST, PORT TYPE and TRANSPORT values are the same as for
&lsquo;<samp>add endpoint</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>remove interface INTERFACE DELAY [FILTER]</samp>&rsquo;</dt>
<dd><p>Removes an interface added through the &lsquo;<samp>add interface</samp>&rsquo; command.
The INTERFACE, DELAY and FILTER values are the same as for &lsquo;<samp>add interface</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>remove paramter KEY VALUE</samp>&rsquo;</dt>
<dd><p>Removes a paramter added through the &lsquo;<samp>add parameter</samp>&rsquo; command.
The KEY and VALUE values are the same as for &lsquo;<samp>remove parameter</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>remove target PROTOCOL ADDRESS</samp>&rsquo;</dt>
<dd><p>Removes a target added through the &lsquo;<samp>remove target</samp>&rsquo; command.
The PROTOCOL and ADDRESS values are the same as for &lsquo;<samp>add target</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>show endpoints</samp>&rsquo;</dt>
<dd><p>Displays a table showing endpoints.
</p>
</dd>
<dt>&lsquo;<samp>show interfaces</samp>&rsquo;</dt>
<dd><p>Displays a table showing interfaces.
</p>
</dd>
<dt>&lsquo;<samp>show parameters</samp>&rsquo;</dt>
<dd><p>Displays a table showing parameters.
</p>
</dd>
<dt>&lsquo;<samp>show targets</samp>&rsquo;</dt>
<dd><p>Displays a table showing targets.
</p>
</dd>
</dl>


<hr>
<a name="Output-streaming-protocols"></a>
<div class="header">
<p>
Next: <a href="#Management-protocol" accesskey="n" rel="next">Management protocol</a>, Previous: <a href="#cyberprobe_002dcli-commands" accesskey="p" rel="prev"><code>cyberprobe-cli</code> commands</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Output-streaming-protocols-1"></a>
<h3 class="section">6.5 Output streaming protocols</h3>

<a name="index-NHIS-1_002e1-LI"></a>
<a name="index-ETSI-LI"></a>
<a name="index-NHIS-1_002e1"></a>
<a name="index-ETSI"></a>
<a name="index-ETSI-TS-102-232_002d1"></a>
<a name="index-TS-102-232_002d1"></a>
<a name="index-LIID"></a>

<p><code>cyberprobe</code> supports packet output in one of two output formats,
which are both LI formats. LI formats were chosen as they set good, open
standards for streaming packets to a destination. There are also existing
security products such as firewalls, and analysis tools which understand
with these protocols. The two formats are ETSI LI and NHIS 1.1.
</p>
<a name="index-TS-102-232_002d3"></a>
<a name="index-ETSI-TS-102-232_002d3"></a>
<a name="ETSI-LI"></a><a name="ETSI-LI-1"></a>
<h3 class="heading">ETSI LI</h3>

<p>The first of the formats supported is the ETSI LI format (see ETSI TS 102
232), which is used in Europe and internationally. The protocol is described
using an ASN.1 specification which can be downloaded from the ETSI
web-site. Google can find the standards. The over-arching TS 102 232-1
standard describes the transport, while the TS 102 232-3 standard describes
putting the IP packets in the transport.
</p>
<p>Those adverse to the use of ASN.1 technology may prefer the second format.
</p>
<a name="index-TS-101-671"></a>
<a name="index-ETSI-TS-101-671"></a>
<a name="index-GLIC"></a>
<a name="NHIS-LI"></a><a name="NHIS-LI-1"></a>
<h3 class="heading">NHIS LI</h3>

<p>NHIS 1.1 which was defined for use in the UK in the 90s, based on GLIC
in ETSI TS 101 671. The protocol is a much simpler header protocol than ETSI
LI, and needs less work to decode.
</p>
<p>The standard was available on the internet on the <a href="http://gliif.org">http://gliif.org</a>
website, but that web-site has recently gone offline.
</p>
<p>The bluffers guide to decoding goes...
</p>
<ul>
<li> The first 32 bytes after TCP connection are a header. Ignore the first 4
bytes, the latter 28 bytes are the LIID, represented as an ASCII
string. Unused bytes following the LIID are set to zero to pad out to 32
bytes.

</li><li> Once the start header is sent, the following data consists of IP packets
pre-fixed by a 20 byte header. The only information of note in each 20 byte
header is a 2-byte length field at offset 2 (network byte order). This tells
you the length of the IP packet.

</li><li> The IP packets are transmitted until the TCP connection closes.  A separate
TCP connection is used for each LIID.

</li></ul>

<a name="Output-semantics"></a>
<h3 class="heading">Output semantics</h3>

<p><code>cyberprobe</code> automatically reconnects to failed destinations, but
the buffering strategy is very simple. When destinations fail, the packets
are buffered in a small queue, but there is limited buffering, so once the
queue fills, packets will start to be dropped. The locking strategy is
simple, so loss of a single endpoint will currently result in data loss to
all endpoints. This may be a problem for operational scenarios where high
data availability is required.
</p>
<p><code>cyberprobe</code> includes some code to decode the ETSI and NHIS streams,
and also includes two test utilities, <code>etsi-rcvr</code> and
<code>nhis11-rcvr</code> which listen on a specified port number, decode the
stream data, and forward in PCAP format on standard output. Example usage
would be:
</p>
<div class="example">
<pre class="example">etsi-rcvr 10001 | tcpdump -n -r-
nhis11-rcvr 10000 | tcpdump -n -r-
</pre></div>


<hr>
<a name="Management-protocol"></a>
<div class="header">
<p>
Next: <a href="#cybermon-invocation" accesskey="n" rel="next"><code>cybermon</code> invocation</a>, Previous: <a href="#Output-streaming-protocols" accesskey="p" rel="prev">Output streaming protocols</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Management-protocol-1"></a>
<h3 class="section">6.6 Management protocol</h3>
<a name="index-Management-protocol"></a>

<a name="Overview-2"></a>
<h3 class="heading">Overview</h3>

<p>The management interface is a simple interface which supports studying and
dynamically changing the cyberprobe configuration: endpoints, targets and
interfaces.
</p>
<p>The configuration file specifies a port number, and username and password
for the interface.
</p>
<p>The interface is intended to be used programmatically, but it is usable
using a basic telnet. It is a command-response interface, similar in style
to SMTP.
</p>
<a name="Commands"></a>
<h3 class="heading">Commands</h3>

<p>Commands are sent, one at a time, as a string terminated by a newline. The
following commands are supported:
</p>
<dl compact="compact">
<dt><code>auth &lt;user&gt; &lt;password&gt;</code></dt>
<dd><p>Used on initial connection to authenticate.
</p>
</dd>
<dt><code>help</code></dt>
<dd><p>Shows help
</p>
</dd>
<dt><code>add_interface &lt;iface&gt; &lt;delay&gt; [&lt;filter&gt;]</code></dt>
<dd><p>Starts packet capture from an interface.
</p>
</dd>
<dt><code>remove_interface &lt;iface&gt; &lt;delay&gt; [&lt;filter&gt;]</code></dt>
<dd><p>Removes a previously enabled packet capture.
</p>
</dd>
<dt><code>interfaces</code></dt>
<dd><p>Lists all interfaces, output is format <code>iface:delay:filter</code>.
</p>
</dd>
<dt><code>add_endpoint &lt;host&gt; &lt;port&gt; &lt;type&gt; &lt;transport&gt;</code></dt>
<dd><p>Adds an endpoint to delivery data to.
where type is one of: <code>etsi</code> <code>nhis1.1</code> and
transport is one of: <code>tcp</code> <code>tls</code>.
Note that it is not currently possible to specify the configuration required to
get a TLS connection to work. (FIXME).
</p>
</dd>
<dt><code>remove_endpoint &lt;host&gt; &lt;port&gt; &lt;type&gt; &lt;transport&gt;</code></dt>
<dd><p>Removes a previously enabled endpoint.
where type is one of: <code>etsi</code> <code>nhis1.1</code> and
transport is one of: <code>tcp</code> <code>tls</code>.
</p>
</dd>
<dt><code>endpoints</code></dt>
<dd><p>Lists endpoints, format is <code>host:port:type:description</code>.
</p>
</dd>
<dt><code>add_target &lt;liid&gt; &lt;class&gt; &lt;address&gt;</code></dt>
<dt><code>add_target &lt;liid&gt; &lt;class&gt; &lt;address&gt;/&lt;mask&gt;</code></dt>
<dd><p>Adds a new targeted IP address.
where class is one of: <code>ipv4</code> <code>ipv6</code>
</p>
</dd>
<dt><code>remove_target &lt;liid&gt; &lt;class&gt; &lt;address&gt;</code></dt>
<dt><code>remove_target &lt;liid&gt; &lt;class&gt; &lt;address&gt;/&lt;mask&gt;</code></dt>
<dd><p>Removes a previously targeted IP address.
where class is one of: <code>ipv4</code> <code>ipv6</code>
</p>
</dd>
<dt><code>targets</code></dt>
<dd><p>Lists targets, format is <code>liid:class:address/mask</code>.  The mask
value is always present, even when no mask was present when the target
was added.
</p>
</dd>
<dt><code>add_parameter &lt;key&gt; &lt;val&gt;</code></dt>
<dd><p>Adds a new parameter, or changes a parameter value.
</p>
</dd>
<dt><code>remove_target &lt;key&gt;</code></dt>
<dd><p>Removes a parameter value.
</p>
</dd>
<dt><code>parameters</code></dt>
<dd><p>Lists parameters, format is <code>key:value</code>.
</p>
</dd>
</dl>

<p>In response to a command, one of the following responses may occur:
</p>
<ul>
<li> An OK response, which is a <code>200</code> status code and message. e.g.
<code>200 Endpoint added.</code>

</li><li> An error message, which is also a status code and message. e.g.
<code>301 Command not known.</code>

</li></ul>

<p>Error codes always start with 3 or 5. A 3xx error code results from
something which is your fault e.g. procedural or syntactic violation, 5xx
error codes result from errors internal to the system. This is still
probably your fault :) e.g. specifying an interface which doesn&rsquo;t exist.
</p>
<p>A response with a body, which is a 201 status code and message. This is
followed by a single line containing a response size in bytes, followed by
the response itself. e.g.
</p>
<div class="example">
<pre class="example">201 Interfaces list follows.
8
eth0:1:
</pre></div>

<a name="Example-session"></a>
<h3 class="heading">Example session</h3>

<p>For clarity, commands sent to the server are highlighted with &lsquo;<samp>&gt;&gt;</samp>&rsquo;
although this is not present as a prompt or in the protocol dialogue.
</p>
<div class="example">
<pre class="example">&gt;&gt;  interfaces
    330 Authenticate before continuing.
&gt;&gt;  auth user password
    200 Authenticated.
&gt;&gt;  interfaces
    201 Interfaces list follows.
    8
    p4p1:1:
&gt;&gt;  remove_interface p4p1 1
    200 Removed interface.
&gt;&gt;  add_interface p4p1 8
    200 Added interface.
&gt;&gt;  add_target 123456 ipv4 1.2.3.4
    200 Added target.
&gt;&gt;  targets
    201 Targets list follows.
    65
    123456:ipv4:1.2.3.4/32
    123456:ipv4:192.168.1.80/32
    123456:ipv6:aaaa:bbbb:cccc:dddd::4:5:6/128
&gt;&gt;  quit
    200 Tra, then.
</pre></div>


<hr>
<a name="cybermon-invocation"></a>
<div class="header">
<p>
Next: <a href="#cybermon-configuration" accesskey="n" rel="next"><code>cybermon</code> configuration</a>, Previous: <a href="#Management-protocol" accesskey="p" rel="prev">Management protocol</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cybermon-invocation-1"></a>
<h3 class="section">6.7 <code>cybermon</code> invocation</h3>

<a name="index-cybermon_002c-invocation"></a>

<p><code>cybermon</code> is a configurable network packet stream analyser.  It is
designed to receive packets from cyberprobe, analyse them and generate
session/transport level events which result in user-configurable
actions. For each event, a call is made to a Lua script which the caller
provides.  Synposes:
</p>
<div class="example">
<pre class="example">cybermon [--help] [--transport TRANSPORT] [--port PORT] [--key KEY]
        [--certificate CERT] [--trusted-ca CHAIN] [--pcap PCAP_FILE]
        [--config CONFIG]
</pre></div>

<ul>
<li> <var>TRANSPORT</var>
is either &lsquo;<samp>tcp</samp>&rsquo; or &lsquo;<samp>tls</samp>&rsquo;.  If &lsquo;<samp>tls</samp>&rsquo; is specified, &lsquo;<samp>cybermon</samp>&rsquo;
expects to read data over TLS.  In TLS mode, it is necessary to specify the
key, certificate, and trusted CA files.

</li><li> <var>PORT</var>
is a TCP port number.  This form of the command runs as a TCP server
listening for ETSI LI streams.  See <a href="#ETSI-LI">ETSI LI</a>.

</li><li> <var>KEY</var>
specifies a filename for the private key in PEM format.  Only used in TLS mode.

</li><li> <var>CERT</var>
specifies a filename for the public certificate in PEM format.
Only used in TLS mode.

</li><li> <var>CHAIN</var>
specifies a filename for trusted CA keys in PEM format.  Only used in TLS mode.

</li><li> <var>PCAP_FILE</var>
is a PCAP file to read.  This form of the command reads the PCAP file, and
then exits.  If the file is &lsquo;<samp>-</samp>&rsquo;, standard input is read.

</li><li> <var>CONFIG</var>
is a Lua configuration file, which specifies the action <code>cybermon</code>
should take when certain events are observed.  See
<a href="#cybermon-configuration"><code>cybermon</code> configuration</a>.

</li></ul>


<hr>
<a name="cybermon-configuration"></a>
<div class="header">
<p>
Next: <a href="#cybermon-example-configurations" accesskey="n" rel="next"><code>cybermon</code> example configurations</a>, Previous: <a href="#cybermon-invocation" accesskey="p" rel="prev"><code>cybermon</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cybermon-configuration-1"></a>
<h3 class="section">6.8 <code>cybermon</code> configuration</h3>

<a name="Overview-3"></a>
<h3 class="heading">Overview</h3>

<p>Cybermon is a simple monitoring tool. It receives the ETSI protocol, decodes
the protocols, and makes decoded information available for further handling
which you can specify. The tool is very much a work in progress - it has
limited protocol decode capability at the moment, but there&rsquo;s enough there
to demonstrate the idea.  Usage
</p>
<p>Usage is: <code>cybermon &lt;port-number&gt; &lt;config-file&gt;</code>
</p>
<p>You specify a port number to receive data on, and a configuration file
written in Lua. Lua is a simple but powerful scripting language. Here&rsquo;s an
example to help you see how the configuration is used.
</p>
<a name="Example-configuration"></a>
<h3 class="heading">Example configuration</h3>

<p>The configuration file is there to provide functions which get called when
certain events occur. The calling interface is fairly simple at the moment,
and over time, expect to see a richer interface develop.
</p>
<p>To start with, we create the structure of the configuration file. Call it
something with a <code>.lua</code> extension e.g. <code>config.lua</code> so that your
editor knows how to indent the code. The basic structure is a module which a
number of functions:
</p>
<div class="example">
<pre class="example">local observer = {}

-- This function is called when a trigger events starts collection of an
-- attacker. liid=the trigger ID, addr=trigger address
observer.trigger_up = function(liid, addr)
end

-- This function is called when an attacker goes off the air
observer.trigger_down = function(liid)
end

-- This function is called when a stream-orientated connection is made
-- (e.g. TCP)
observer.connection_up = function(context)
end

-- This function is called when a stream-orientated connection is closed
observer.connection_down = function(context)
end

-- This function is called when a datagram is observed, but the protocol
-- is not recognised.
observer.unrecognised_datagram = function(context, data)
end

-- This function is called when stream data  is observed, but the
-- protocol is not recognised.
observer.unrecognised_stream = function(context, data)
end

-- This function is called when an ICMP message is observed.
observer.icmp = function(context, data)
end

-- This function is called when an HTTP request is observed.
observer.http_request = function(context, method, url, header, body)
end

-- This function is called when an HTTP response is observed.
observer.http_response = function(context, code, status, header, url,
                         body)
end

-- This function is called when a DNS message is observed.
observer.dns_message = function(context, header, queries, answers, auth,
                                add)
end

-- Return the table
return observer
</pre></div>

<a name="index-LUA-events"></a>
<a name="index-cybermon-events"></a>
<a name="LUA-event-calls"></a>
<h3 class="heading">LUA event calls</h3>

<p>The configuration file is expected to provide the following functions, which
are called in response to <code>cybermon</code> events.
</p>
<dl compact="compact">
<dt><code>trigger_up(liid, address)</code></dt>
<dd>
<p>Called when an attacker is seen coming on-stream. The <code>liid</code> parameter
describes the target ID, and <code>address</code> contains the IP address in
string form.
</p>
</dd>
<dt><code>trigger_down(liid)</code></dt>
<dd><p>Called when an attacker is seen going off-stream. The <code>liid</code> parameter
describes the target ID.
</p>
</dd>
<dt><code>connection_up(context)</code></dt>
<dd><p>Called when a stream-based connection (e.g. TCP) is made. The <code>context</code>
parameter is a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>connection_down(context)</code></dt>
<dd><p>Similar to <code>connection_up</code>, called when a connection closes.
</p>
</dd>
<dt><code>icmp(context, data)</code></dt>
<dd><p>Called when an ICMP message is detected. The <code>data</code> parameter contains
the ICMP message body.
</p>
</dd>
<dt><code>http_request(context, method, url, header, body)</code></dt>
<dd><p>Called when an HTTP request is observed. The HTTP method and URL are
described in the <code>method</code> and <code>url</code> parameters. The <code>header</code>
parameter is a LUA table, which describes the HTTP header key/value
pairs. If there is an HTTP payload in the request, it is contained in the
<code>body</code> parameter, which is a string. Otherwise body will be an empty
string.
</p>
</dd>
<dt><code>http_response(context, code, status, header, url, body)</code></dt>
<dd><p>Called when an HTTP response is observed. The HTTP response code and status
are described in the <code>code</code> and <code>status</code> parameters. The
<code>header</code> parameter is a LUA table, which describes the HTTP header
key/value pairs. If there is an HTTP payload in the response, it is
contained in the <code>body</code> parameter, which is a string. Otherwise body
will be an empty string.
</p>
</dd>
<dt><code>smtp_command(context, command)</code></dt>
<dd><p>Called when an SMTP command is observed i.e. a single line message going to
the server from a client. The <code>command</code> parameter contains the command
string.
</p>
</dd>
<dt><code>smtp_response(context, status, text)</code></dt>
<dd><p>Called when an SMTP response is observed. That is, status going from server
to client following a command. The <code>status</code> parameter is the status
number e.g. 200. The <code>text</code> parameter contains the response text,
described as a list of strings. Responses may occur over a number of lines,
hence the parameter is a list: For single-line responses, there is only a
single item in the list.
</p>
</dd>
<dt><code>smtp_data(context, from, to, data)</code></dt>
<dd><p>Called when an SMTP payload is observed i.e. the body of text following the
DATA command. To aid processing, the SMTP protocol processor assembles
information from other commands: the <code>from</code> parameter contains the
email From address described in the MAIL FROM command. The <code>to</code>
parameter is a list of addresses contained in all RCPT TO commands. The
<code>data</code> parameter contains the email body - it will be an RFC822
payload.
</p>
</dd>
<dt><code>ftp_command(context, command)</code></dt>
<dd><p>Called when an FTP command is observed i.e. a single line message going to
the server from a client. The <code>command</code> parameter contains the command
string.
</p>
</dd>
<dt><code>ftp_response(context, status, text)</code></dt>
<dd><p>Called when an FTP response is observed. That is, status going from server
to client following a command. The <code>status</code> parameter is the status
number e.g. 200. The <code>text</code> parameter contains the response text,
described as a list of strings. Responses may occur over a number of lines,
hence the parameter is a list: For single-line responses, there is only a
single item in the list.
</p>
</dd>
<dt><code>dns_message(context, header, queries, answers, auth, add)</code></dt>
<dd><p>Called when a DNS message is observed. The decoded DNS message is described
in the parameters: <code>header</code> is the DNS header, <code>queries</code> contains
the DNS queries, <code>answers</code> contains the answers in a response message,
<code>auth</code> contains DNS nameserver authority descriptions, and <code>add</code>
provides additional information.
</p>
</dd>
<dt><code>unrecognised_datagram(context, data)</code></dt>
<dd><p>Called when a datagram is received using a protocol which isn&rsquo;t
recognised. Currently, only DNS and ICMP are recognised. Any other UDP
protocol results in a call to this function.
</p>
</dd>
<dt><code>unrecognised_stream(context, data)</code></dt>
<dd><p>Called when connection-orientated data is received using a protocol which
isn&rsquo;t recognised. Currently, only HTTP, SMTP and FTP are recognised. Any
other TCP protocol results in calls to this function whenever data is
observed.
</p>
</dd>
</dl>

<a name="index-context-object"></a>
<a name="index-cybermon-context-object"></a>
<a name="Context-object"></a>
<h3 class="heading">Context object</h3>

<p>From the LUA code there, the <code>context</code> variable has a number of method
functions which can be called:
</p>
<dl compact="compact">
<dt><code>context:get_type()</code></dt>
<dd><p>Returns the protocol type of the context e.g. <code>http</code>, <code>tcp</code>, <code>udp</code>, <code>dns</code>, <code>ip4</code>
</p>
</dd>
<dt><code>context:get_parent()</code></dt>
<dd>
<p>Returns the parent context relating to a context. This can be used to travel
&quot;up&quot; the protocol stack. For example, call get_parent on a TCP context will
return the IP context.
</p>
</dd>
<dt><code>context:get_src_addr()</code></dt>
<dd><p>Returns the source address relating to a context. Returns two string
variables: the first is the address class e.g. <code>ipv4</code>, the second is the
address value e.g. <code>1.2.3.4</code>.
</p>
</dd>
<dt><code>context:get_dest_addr()</code></dt>
<dd><p>Returns the destination address relating to a context. Returns two string
variables: the first is the address class e.g. <code>ipv4</code>, the second is the
address value e.g. <code>1.2.3.4</code>.
</p>
</dd>
<dt><code>context:get_reverse()</code></dt>
<dd><p>Returns the context relating to the &quot;other side&quot; of a communication, but
only if this has been identified. On an HTTP response, <code>get_reverse</code>
will return the HTTP request. In the <code>http_request</code> function you will
not be able to use <code>get_reverse</code> to find the HTTP response because the
response does not exist at the point the request is identified.
</p>
</dd>
<dt><code>context:get_id()</code></dt>
<dd><p>Returns a context&rsquo;s unique ID. Can be useful for tracking, or can be used as
index into your own LUA structures to associate information with contexts.
</p>
</dd>
<dt><code>context:describe_src()</code></dt>
<dd><p>Returns a human readable description of the protocol stack using source
addresses.
</p>
</dd>
<dt><code>context:describe_dest()</code></dt>
<dd><p>Returns a human readable description of the protocol stack using source
addresses.
</p>
</dd>
<dt><code>context:get_liid()</code></dt>
<dd><p>Returns the trigger ID associated with a &quot;target&quot;.
</p>
</dd>
<dt><code>context:get_network_info()</code></dt>
<dd><p>Returns two variables: the source and destination network addresses (IP
addresses) for this data. These are in normal IP address string format.
</p>
</dd>
<dt><code>context:get_trigger_info()</code></dt>
<dd><p>Returns the IP address which triggered this collection, if known. If not,
<code>0.0.0.0</code>x is returned. This is in normal IP address string format.
</p>
</dd>
<dt><code>context:forge_tcp_reset()</code></dt>
<dd><p>Creates a TCP reset packet and directs it at the source address associated
with this context. Must have TCP protocol present in the stack.
</p>
</dd>
<dt><code>context:forge_dns_response(header, queries, answers, add)</code></dt>
<dd><p>Creates a DNS message and directs it at the source
address associated with this context. The provided parameters are used as
protocol data in the DNS encoder.
</p>
</dd>
</dl>


<hr>
<a name="cybermon-example-configurations"></a>
<div class="header">
<p>
Next: <a href="#Cybermon-ZeroMQ-message-format" accesskey="n" rel="next">Cybermon ZeroMQ message format</a>, Previous: <a href="#cybermon-configuration" accesskey="p" rel="prev"><code>cybermon</code> configuration</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cybermon-example-configurations-1"></a>
<h3 class="section">6.9 <code>cybermon</code> example configurations</h3>

<a name="index-cybermon_002c-example-configurations"></a>
<a name="index-cybermon_002c-configuration-1"></a>
<a name="Example-configuration-files"></a>
<h3 class="heading">Example configuration files</h3>

<dl compact="compact">
<dt><samp>db.lua</samp></dt>
<dd>
<p>Connects to a local ElasticSearch instance, and generates observations
which are stored as <code>observation</code> objects in the <code>cyberprobe</code>
index.  A mapping is applied which applies a time-to-live of 1 hour on
all objects.
</p>
</dd>
<dt><samp>dump.lua</samp></dt>
<dd>
<p>Outputs event payloads to <samp>data/dump.*</samp> files.
</p>
</dd>
<dt><samp>forge-dns.lua</samp></dt>
<dd>
<p>Example Lua script, spots DNS queries for &lsquo;<samp>example.org</samp>&rsquo;, and responds
with made-up IP addresses.
</p>
</dd>
<dt><samp>forge-reset.lua</samp></dt>
<dd>
<p>Example script, spots TCP port 22 sessions (which is the port number normally
used for SSH sessions).  If detected, a TCP reset is forged.
</p>
</dd>
<dt><samp>hexdump.lua</samp></dt>
<dd>
<p>Like <samp>monitor.lua</samp>, but adds a hex-dump of event payloads to the output.
</p>
</dd>
<dt><samp>monitor.lua</samp></dt>
<dd>
<p>For each Lua event, outputs a plain text summary of the output on standard
output.
</p>
</dd>
<dt><samp>zeromq.lua</samp></dt>
<dd>
<a name="index-ZeroMQ"></a>
<a name="index-Cybermon-ZeroMQ-message-format"></a>
<a name="index-publish_002fsubscribe"></a>
<a name="index-pub_002fsub"></a>

<p>For each Lua event, a JSON record is formatted and published to a ZeroMQ
queue on port 5555.  See <a href="#Cybermon-ZeroMQ-message-format">Cybermon ZeroMQ message format</a>.
</p>
</dd>
<dt><samp>quiet.lua</samp></dt>
<dd>
<p>Does nothing.  This is an empty code shell, and a good template to write
your own event handler.
</p>
</dd>
<dt><samp>stix+alert.lua</samp></dt>
<dd>
<p>Looks in the current directory for the JSON file
<samp>stix-default-combined.json</samp> which is read for STIX indicators.
</p>
<p>Then, scans events for threats, and if detected are alerted on standard output
in a human-readable form.
</p>
</dd>
<dt><samp>stix+db.lua</samp></dt>
<dd><a name="index-stix_002bdb_002elua-configuration-file-1"></a>
<a name="index-cybermon_002c-stix_002bdb_002elua-configuration-file-1"></a>

<p>Like <samp>stix+alert.lua</samp> but also generates ElasticSearch observations
as <samp>db.lua</samp> does.  The ElasticSearch observations have threat hit
information added.q
</p>
</dd>
<dt><samp>volmon+alert.lua</samp></dt>
<dd>
<p>Like <samp>volmon</samp> but alerts are written to a TCP server on port 10101.
</p>
</dd>
<dt><samp>volmon.lua</samp></dt>
<dd>
<p>Monitors all sessions and calculates volumes of data.  Creates a human-readable
alert when volumes exceed a certain value.
</p>
</dd>
</dl>

<a name="Utilities"></a>
<h3 class="heading">Utilities</h3>

<p>The <samp>/usr/local/etc/cyberprobe/util</samp> directory contains some Lua
utilities which can be used by other Lua configuration files.  They can be
loaded as modules e.g.
</p>
<div class="example">
<pre class="example">local addr = require(&quot;util.addresses&quot;)
</pre></div>

<p>The utilities are:
</p>
<dl compact="compact">
<dt><samp>addresses.lua</samp></dt>
<dd>
<p>Some <code>cybermon</code> address handling functions.
</p>
</dd>
<dt><samp>elastic.lua</samp></dt>
<dd>
<p>ElasticSearch observation creation.
</p>
</dd>
<dt><samp>http.lua</samp></dt>
<dd>
<p>HTTP transport functions.
</p>
</dd>
<dt><samp>stix.lua</samp></dt>
<dd>
<p>Utilities used to read STIX threat specifications, and detect their presence
in <code>cybermon</code> events.
</p>
</dd>
</dl>


<hr>
<a name="Cybermon-ZeroMQ-message-format"></a>
<div class="header">
<p>
Next: <a href="#cybermon_002dmonitor-invocation" accesskey="n" rel="next"><code>cybermon-monitor</code> invocation</a>, Previous: <a href="#cybermon-example-configurations" accesskey="p" rel="prev"><code>cybermon</code> example configurations</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Cybermon-ZeroMQ-message-format-1"></a>
<h3 class="section">6.10 Cybermon ZeroMQ message format</h3>

<a name="index-ZeroMQ-1"></a>
<a name="index-Cybermon-ZeroMQ-message-format-1"></a>
<a name="index-publish_002fsubscribe-1"></a>
<a name="index-pub_002fsub-1"></a>

<p>Cybermon&rsquo;s &lsquo;<samp>zeromq.lua</samp>&rsquo; configuration file transmits messages to a
ZeroMQ message queue in JSON format.  Each message is a JSON object
with the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>id</samp>&rsquo;</dt>
<dd><p>Unique ID for the event: UUID format
(e.g. 3c55d830-8d99-48a1-c8cd-ca77514a6d10).
</p>
</dd>
<dt>&lsquo;<samp>device</samp>&rsquo;</dt>
<dd><p>Device identifier / LIID.
</p>
</dd>
<dt>&lsquo;<samp>action</samp>&rsquo;</dt>
<dd><p>The event type.  One of:
</p><dl compact="compact">
<dt>&lsquo;<samp>connected_up</samp>&rsquo;</dt>
<dd><p>Records the creation of a stream-orientated connection (currently, only TCP).
This event is created for all connections whether the protocol is
recognised or not.
</p></dd>
<dt>&lsquo;<samp>connected_down</samp>&rsquo;</dt>
<dd><p>Records the closing of a stream-orientated connection (currently, only TCP).
This event is created for all connections whether the protocol is
recognised or not.
</p></dd>
<dt>&lsquo;<samp>unrecognised_stream</samp>&rsquo;</dt>
<dd><p>Records the sending of a PDU on a connection-less transport (currently, only
UDP) whose protocol has not been recognised.
</p></dd>
<dt>&lsquo;<samp>unrecognised_datagram</samp>&rsquo;</dt>
<dd><p>Records the sending of a PDU on a connection-less transport (currently, only
UDP) whose protocol has not been recognised.
</p></dd>
<dt>&lsquo;<samp>http_request</samp>&rsquo;</dt>
<dd><p>Records the sending of an HTTP request.
</p></dd>
<dt>&lsquo;<samp>http_response</samp>&rsquo;</dt>
<dd><p>Records the sending of an HTTP response.
</p></dd>
<dt>&lsquo;<samp>dns_message</samp>&rsquo;</dt>
<dd><p>Records the sending of a DNS message (request and response).
</p></dd>
<dt>&lsquo;<samp>icmp</samp>&rsquo;</dt>
<dd><p>Records the sending of an ICMP message.
</p></dd>
<dt>&lsquo;<samp>smtp_command</samp>&rsquo;</dt>
<dd><p>Records the sending of an SMTP command.  This is a message from client
to server.  Data commands are not recorded with this event - there is an
&lsquo;<samp>smtp_data</samp>&rsquo; event which records this.
</p></dd>
<dt>&lsquo;<samp>smtp_response</samp>&rsquo;</dt>
<dd><p>Records the sending of a response to an SMTP command.  This is a status
message from server to client.
</p></dd>
<dt>&lsquo;<samp>smtp_data</samp>&rsquo;</dt>
<dd><p>Records an SMTP data transaction, including the full SMTP data payload
(essentially an email).
</p></dd>
<dt>&lsquo;<samp>ftp_command</samp>&rsquo;</dt>
<dd><p>Records an FTP command (client to server).
</p></dd>
<dt>&lsquo;<samp>ftp_response</samp>&rsquo;</dt>
<dd><p>Records an FTP response (server to client).
</p></dd>
</dl>

</dd>
<dt>&lsquo;<samp>queries</samp>&rsquo;</dt>
<dd><p>A list of strings describing the set of DNS queries in
&lsquo;<samp>dns_message</samp>&rsquo; actions.
</p>
</dd>
<dt>&lsquo;<samp>answers</samp>&rsquo;</dt>
<dd><p>Describes DNS answer records in &lsquo;<samp>dns_message</samp>&rsquo; actions.  Is a list
of objects with &lsquo;<samp>name</samp>&rsquo; and &lsquo;<samp>address</samp>&rsquo; fields containing strings
for name and IP address.
</p>
</dd>
<dt>&lsquo;<samp>type</samp>&rsquo;</dt>
<dd><p>DNS message type, one of &lsquo;<samp>query</samp>&rsquo; or &lsquo;<samp>response</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>method</samp>&rsquo;</dt>
<dd><p>HTTP method
</p>
</dd>
<dt>&lsquo;<samp>url</samp>&rsquo;</dt>
<dd><p>HTTP URL.
</p>
</dd>
<dt>&lsquo;<samp>header</samp>&rsquo;</dt>
<dd><p>An object containing key/value pairs for HTTP header.
</p>
</dd>
<dt>&lsquo;<samp>code</samp>&rsquo;</dt>
<dd><p>A response code in HTTP response, SMTP response or FTP response.
</p>
</dd>
<dt>&lsquo;<samp>status</samp>&rsquo;</dt>
<dd><p>A human-readable status string in HTTP response, SMTP response or FTP response.
</p>
</dd>
<dt>&lsquo;<samp>command</samp>&rsquo;</dt>
<dd><p>Command string in FTP or SMTP protocols.
</p>
</dd>
<dt>&lsquo;<samp>text</samp>&rsquo;</dt>
<dd><p>Reply text in FTP or SMTP protocols.
</p>
</dd>
</dl>


<hr>
<a name="cybermon_002dmonitor-invocation"></a>
<div class="header">
<p>
Next: <a href="#cybermon_002delasticsearch-invocation" accesskey="n" rel="next"><code>cybermon-elasticsearch</code> invocation</a>, Previous: <a href="#Cybermon-ZeroMQ-message-format" accesskey="p" rel="prev">Cybermon ZeroMQ message format</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cybermon_002dmonitor-invocation-1"></a>
<h3 class="section">6.11 <code>cybermon-monitor</code> invocation</h3>

<a name="index-cybermon_002dmonitor_002c-invocation-1"></a>

<p><code>cybermon-monitor</code> subscribes to a ZeroMQ pub/sub queue for
<code>cybermon</code>
events, and upon receipt of events, formats them for output in a human-readable
manner.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-monitor [BINDING]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-monitor
cybermon-monitor tcp://localhost:5555
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the ZeroMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>tcp://localhost:5555</samp>&rsquo;.
</p>
</dd>
</dl>


<hr>
<a name="cybermon_002delasticsearch-invocation"></a>
<div class="header">
<p>
Next: <a href="#cybermon_002dbigquery-invocation" accesskey="n" rel="next"><code>cybermon-bigquery</code> invocation</a>, Previous: <a href="#cybermon_002dmonitor-invocation" accesskey="p" rel="prev"><code>cybermon-monitor</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cybermon_002delasticsearch-invocation-1"></a>
<h3 class="section">6.12 <code>cybermon-elasticsearch</code> invocation</h3>

<a name="index-cybermon_002delasticsearch_002c-invocation-1"></a>

<p><code>cybermon-elasticsearch</code> subscribes to a ZeroMQ pub/sub queue for
<code>cybermon</code>
events, and upon receipt of events, formats them for delivery to an
ElasticSearch store.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-elasticsearch [BINDING [ELASTICSEARCH-URL] ]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-elasticsearch
cybermon-elasticsearch tcp://localhost:5555 http://elastic-store:9200/
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the ZeroMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>tcp://localhost:5555</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>ELASTICSEARCH-URL</samp>&rsquo;</dt>
<dd><p>Specifies the base URL for ElasticSearch.  If not specified, defaults
to &lsquo;<samp>http://localhost:9200</samp>&rsquo;.
</p>
</dd>
</dl>


<hr>
<a name="cybermon_002dbigquery-invocation"></a>
<div class="header">
<p>
Next: <a href="#cybermon_002dgaffer-invocation" accesskey="n" rel="next"><code>cybermon-gaffer</code> invocation</a>, Previous: <a href="#cybermon_002delasticsearch-invocation" accesskey="p" rel="prev"><code>cybermon-elasticsearch</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cybermon_002dbigquery-invocation-1"></a>
<h3 class="section">6.13 <code>cybermon-bigquery</code> invocation</h3>

<a name="index-cybermon_002dbigquery_002c-invocation-1"></a>

<p><code>cybermon-bigquery</code> subscribes to a ZeroMQ pub/sub queue for
<code>cybermon</code>
events, and upon receipt of events, formats them for delivery to a Google
BigQuery table.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-bigquery [BINDING [KEY-FILE [PROJECT [DATASET [TABLE] ] ] ] ]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-bigquery
cybermon-bigquery tcp://localhost:5555 /priv.json
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the ZeroMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>tcp://localhost:5555</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>KEY-FILE</samp>&rsquo;</dt>
<dd><p>Specifies the path to a Google cloud key file in &rsquo;private JSON&rsquo; format.
If not specified, defaults
to <samp>/etc/cyberprobe/private.json</samp>.
</p>
</dd>
<dt>&lsquo;<samp>PROJECT</samp>&rsquo;</dt>
<dd><p>Specifies the Google Cloud project ID to use.  Defaults to the project ID
specified in the private JSON key file.
</p>
</dd>
<dt>&lsquo;<samp>DATASET</samp>&rsquo;</dt>
<dd><p>Specifies the BigQuery data set, defaults to &lsquo;<samp>cyberprobe</samp>&rsquo;.  You need to
create this dataset, it is not created for you.
</p>
</dd>
<dt>&lsquo;<samp>TABLE</samp>&rsquo;</dt>
<dd><p>Specifies the BigQuery table within the dataset.  This is created if it does
not already exist.  Don&rsquo;t try to create this yourself, if you use the wrong
schema, data won&rsquo;t load correctly.
</p>
</dd>
</dl>


<hr>
<a name="cybermon_002dgaffer-invocation"></a>
<div class="header">
<p>
Next: <a href="#cybermon_002dcassandra-invocation" accesskey="n" rel="next"><code>cybermon-cassandra</code> invocation</a>, Previous: <a href="#cybermon_002dbigquery-invocation" accesskey="p" rel="prev"><code>cybermon-bigquery</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cybermon_002dgaffer-invocation-1"></a>
<h3 class="section">6.14 <code>cybermon-gaffer</code> invocation</h3>

<a name="index-cybermon_002dgaffer_002c-invocation-1"></a>
<a name="index-Gaffer-1"></a>
<a name="index-Graph-store-2"></a>

<p><code>cybermon-gaffer</code> subscribes to a ZeroMQ pub/sub queue for
<code>cybermon</code>
events, and upon receipt of events, formats them for delivery to a
Gaffer store.  The format used is intended to allow Gaffer to be used
as an RDF store with SPARQL query.  To query and visualise the data stored in
Gaffer, see <a href="https://github.com/cybermaggedon/gaffer-tools">https://github.com/cybermaggedon/gaffer-tools</a>.
To get started with Gaffer quickly, a docker container for development
can be found at
<a href="https://docker.io/cybermaggedon/gaffer">https://docker.io/cybermaggedon/gaffer</a>.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-gaffer [BINDING [GAFFER-URL] ]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-gaffer
cybermon-gaffer tcp://localhost:5555 http://gaffer-store:8080/example-rest/v1
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the ZeroMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>tcp://localhost:5555</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>GAFFER-URL</samp>&rsquo;</dt>
<dd><p>Specifies the base URL for Gaffer.  If not specified, defaults
to &lsquo;<samp>http://gaffer:8080/example-rest/v1</samp>&rsquo;.
</p>
</dd>
</dl>


<hr>
<a name="cybermon_002dcassandra-invocation"></a>
<div class="header">
<p>
Next: <a href="#taxii_002dclient-invocation" accesskey="n" rel="next"><code>taxii-client</code> invocation</a>, Previous: <a href="#cybermon_002dgaffer-invocation" accesskey="p" rel="prev"><code>cybermon-gaffer</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="cybermon_002dcassandra-invocation-1"></a>
<h3 class="section">6.15 <code>cybermon-cassandra</code> invocation</h3>

<a name="index-cybermon_002dcassandra_002c-invocation-1"></a>
<a name="index-Apache-Cassandra-1"></a>
<a name="index-Cassandra-1"></a>
<a name="index-Graph-store-3"></a>

<p><code>cybermon-cassandra</code> subscribes to a ZeroMQ pub/sub queue for
<code>cybermon</code>
events, and upon receipt of events, formats them for delivery to a
Cassandra store.  The format used is intended to allow Cassandra to be used
as an RDF store with SPARQL query.  To query and visualise the data stored in
Cassandra, see <a href="https://github.com/cybermaggedon/cassandra-redland">https://github.com/cybermaggedon/cassandra-redland</a>.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-cassandra [BINDING [CASSANDRA-HOSTS] ]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-cassandra
cybermon-cassandra tcp://localhost:5555 cassandra1,cassandra2
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the ZeroMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>tcp://localhost:5555</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>CASSANDRA-HOSTS</samp>&rsquo;</dt>
<dd><p>Specifies a comma-separated list of Cassandra store hosts to contact.
If not specified, defaults
to &lsquo;<samp>localhost</samp>&rsquo;.
</p>
</dd>
</dl>


<hr>
<a name="taxii_002dclient-invocation"></a>
<div class="header">
<p>
Next: <a href="#taxii_002dsync_002djson-invocation" accesskey="n" rel="next"><code>taxii-sync-json</code> invocation</a>, Previous: <a href="#cybermon_002dcassandra-invocation" accesskey="p" rel="prev"><code>cybermon-cassandra</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="taxii_002dclient-invocation-1"></a>
<h3 class="section">6.16 <code>taxii-client</code> invocation</h3>

<a name="index-taxii_002dclient_002c-invocation"></a>

<p><code>taxii-client</code> provides a means to connect with a TAXII compliant
server to acquire cyber threat information.  TAXII/STIX implementation
is experimental and incomplete.
</p>
<p>See
<a href="https://taxii.mitre.org/">https://taxii.mitre.org/</a> for more information on TAXII and STIX.
Synopsis:
</p>
<div class="example">
<pre class="example">taxii-client [-h] [--host HOST] [--port PORT] [--path PATH]
        [--collection COLLECTION] [--begin_timestamp BEGIN_TS]
        [--end_timestamp END_TS] [--discovery] [--poll]
        [--collection_information] [--subscribe] [--action ACT]
        [--query QUERY] [--subs-id SUBSCRIPTION_ID]
        [--inbox INBOX]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">taxii-client -h taxii.com --poll
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>-h</samp>&rsquo;</dt>
<dt>&lsquo;<samp>--help</samp>&rsquo;</dt>
<dd><p>Shows command line usage.
</p>
</dd>
<dt>&lsquo;<samp>--host <var>HOST</var></samp>&rsquo;</dt>
<dd><p>Specifies host to connect to.
</p>
</dd>
<dt>&lsquo;<samp>--port <var>PORT</var></samp>&rsquo;</dt>
<dd><p>Specifies port number of the TAXII service.
</p>
</dd>
<dt>&lsquo;<samp>--path <var>PATH</var></samp>&rsquo;</dt>
<dd><p>Specifies the URI of the service.  Default is &lsquo;<samp>/</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--collection <var>COLLECTION</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--begin_timestamp <var>BEGIN</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--end_timestamp <var>END</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--discovery</samp>&rsquo;</dt>
<dd><p>Invokes a TAXII discovery action.
</p>
</dd>
<dt>&lsquo;<samp>--poll</samp>&rsquo;</dt>
<dd><p>Invokes a TAXII poll action.
</p>
</dd>
<dt>&lsquo;<samp>--collection_information</samp>&rsquo;</dt>
<dd><p>Invokes a collection information action.
</p>
</dd>
<dt>&lsquo;<samp>--subscribe</samp>&rsquo;</dt>
<dd><p>Invokes a TAXII subscribe action.
</p>
</dd>
<dt>&lsquo;<samp>--action <var>ACT</var></samp>&rsquo;</dt>
<dd><p>Specieis the subscription action to perform.
</p>
</dd>
<dt>&lsquo;<samp>--query <var>QUERY</var></samp>&rsquo;</dt>
<dd><p>Specifies the query to use for an inbox or poll action.  Query takes the
form: &lsquo;<samp>type:value</samp>&rsquo;.  Type can be one of:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>address</samp>&rsquo;</dt>
<dd><p>CybOX address object value e.g. &lsquo;<samp>address:1.2.3.4</samp>&rsquo;
</p>
</dd>
<dt>&lsquo;<samp>addresstype</samp>&rsquo;</dt>
<dd><p>CybOX address object type e.g. &lsquo;<samp>addresstype:e-mail</samp>&rsquo;
</p>
</dd>
<dt>&lsquo;<samp>domainname</samp>&rsquo;</dt>
<dd><p>CybOX DNS name
</p>
</dd>
<dt>&lsquo;<samp>port</samp>&rsquo;</dt>
<dd><p>TCP/UDP port number e.g. &lsquo;<samp>port:11111</samp>&rsquo;
</p>
</dd>
<dt>&lsquo;<samp>hash</samp>&rsquo;</dt>
<dd><p>File object hash value.
</p>
</dd>
<dt>&lsquo;<samp>id</samp>&rsquo;</dt>
<dd><p>Object ID.
</p>
</dd>
<dt>&lsquo;<samp>source</samp>&rsquo;</dt>
<dd><p>Object source identifier.
</p>
</dd>
</dl>

<p>Multiple query values may be specified in which case they are combined with
a logical AND.
</p>
</dd>
<dt>&lsquo;<samp>--subs-id <var>SUBS-ID</var></samp>&rsquo;</dt>
<dd><p>Specifies the subscription ID for a subscription operation.
</p>
</dd>
<dt>&lsquo;<samp>--inbox <var>INBOX</var></samp>&rsquo;</dt>
<dd><p>Specifies the inbox destination for subscriptions.  Defaults to
<code>http://localhost:8888/</code>.
</p>
</dd>
</dl>

<p>Begin/end timestamps take the following form:
</p><div class="example">
<pre class="example">YYYY-MM-DDTHH:MM:SS.ssssss+/-hh:mm
</pre></div>


<hr>
<a name="taxii_002dsync_002djson-invocation"></a>
<div class="header">
<p>
Next: <a href="#taxii_002dserver-invocation" accesskey="n" rel="next"><code>taxii-server</code> invocation</a>, Previous: <a href="#taxii_002dclient-invocation" accesskey="p" rel="prev"><code>taxii-client</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="taxii_002dsync_002djson-invocation-1"></a>
<h3 class="section">6.17 <code>taxii-sync-json</code> invocation</h3>

<a name="index-taxii_002dsync_002djson_002c-invocation"></a>

<a name="index-stix_002bdb_002elua-configuration-file-2"></a>
<a name="index-cybermon_002c-stix_002bdb_002elua-configuration-file-2"></a>
<a name="index-stix_002balert_002elua-configuration-file-2"></a>
<a name="index-cybermon_002c-stix_002balert_002elua-configuration-file-2"></a>

<p><code>taxii-sync-json</code> provides a means to connect with a TAXII compliant
server to acquire cyber threat information.  <code>taxii-sync-json</code>
uses a TAXII poll request, and reformats all STIX information into a single
JSON file which is written to the current directory.  This JSON form is
intended to be used with the <samp>stix+db.lua</samp> and <samp>stix+alert.lua</samp>
configuration files for <code>cybermon</code>.  See
<a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a>.
</p>
<p>TAXII/STIX implementation is experimental and incomplete.
</p>
<p>See
<a href="https://taxii.mitre.org/">https://taxii.mitre.org/</a> for more information on TAXII and STIX.
Synopsis:
</p>
<div class="example">
<pre class="example">taxii-sync-json [-h] [--host HOST] [--port PORT] [--path PATH]
        [--collection COLLECTION] [--begin_timestamp BEGIN_TS]
        [--end_timestamp END_TS]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">taxii-sync-json -h taxii.com
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>-h</samp>&rsquo;</dt>
<dt>&lsquo;<samp>--help</samp>&rsquo;</dt>
<dd><p>Shows command line usage.
</p>
</dd>
<dt>&lsquo;<samp>--host <var>HOST</var></samp>&rsquo;</dt>
<dd><p>Specifies host to connect to.
</p>
</dd>
<dt>&lsquo;<samp>--port <var>PORT</var></samp>&rsquo;</dt>
<dd><p>Specifies port number of the TAXII service.
</p>
</dd>
<dt>&lsquo;<samp>--path <var>PATH</var></samp>&rsquo;</dt>
<dd><p>Specifies the URI of the service.  Default is &lsquo;<samp>/</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--collection <var>COLLECTION</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--begin_timestamp <var>BEGIN</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--end_timestamp <var>END</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
</dl>

<p>The JSON information is written to the current directory to a file called
<samp>stix-<var>COLLECTION</var>-combined.json</samp> where <var>COLLECTION</var> is the
collection name chosen.
</p>
<p>Begin/end timestamps take the following form:
</p><div class="example">
<pre class="example">YYYY-MM-DDTHH:MM:SS.ssssss+/-hh:mm
</pre></div>


<hr>
<a name="taxii_002dserver-invocation"></a>
<div class="header">
<p>
Next: <a href="#nhis11_002drcvr-invocation" accesskey="n" rel="next"><code>nhis11-rcvr</code> invocation</a>, Previous: <a href="#taxii_002dsync_002djson-invocation" accesskey="p" rel="prev"><code>taxii-sync-json</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="taxii_002dserver-invocation-1"></a>
<h3 class="section">6.18 <code>taxii-server</code> invocation</h3>

<a name="index-taxii_002dserver_002c-invocation"></a>

<p><code>taxii-server</code> provides a TAXII compliant
server to distribute cyber threat information.  TAXII/STIX implementation
is experimental and incomplete.
</p>
<p>See
<a href="https://taxii.mitre.org/">https://taxii.mitre.org/</a> for more information on TAXII and STIX.
Synopsis:
</p>
<div class="example">
<pre class="example">taxii-server [-h] [--host HOST] [--port PORT] [--data-dir DATA_DIR]
        [--db DB] [--sync-period SYNC_PERIOD]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">taxii-server --port 8100 --data-dir data/ --db stix.db
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>-h</samp>&rsquo;</dt>
<dt>&lsquo;<samp>--help</samp>&rsquo;</dt>
<dd><p>Shows command line usage.
</p>
</dd>
<dt>&lsquo;<samp>--host <var>HOST</var></samp>&rsquo;</dt>
<dd><p>Host to bind the HTTP service to.
</p>
</dd>
<dt>&lsquo;<samp>--port <var>PORT</var></samp>&rsquo;</dt>
<dd><p>Specifies port number of the TAXII service.
</p>
</dd>
<dt>&lsquo;<samp>--data-dir <var>PATH</var></samp>&rsquo;</dt>
<dd><p>Specifies the directory where STIX files are to be placed.  Directory
structure should be <var>PATH</var>/<var>COLLECTION</var>/<var>STIX-FILE</var>.
</p>
</dd>
<dt>&lsquo;<samp>--db <var>DB</var></samp>&rsquo;</dt>
<dd><p>Specifies a file to hold the STIX data.  Default is <samp>stix_store.db</samp>.
This is created if it does not exist.
</p>
</dd>
<dt>&lsquo;<samp>--sync-period <var>PERIOD</var></samp>&rsquo;</dt>
<dd><p>Specifies the period for synchronising the data directory with the database.
Default is &lsquo;<samp>1</samp>&rsquo;.
</p>
</dd>
</dl>

<p>The TAXII server periodically checks the data directory with the contents
of the database, and updates the database accordingly.  Deleting files results
in deletion from the database, adding files results in creation.  Thus, the
data directory is the master copy for the sync process.
</p>

<hr>
<a name="nhis11_002drcvr-invocation"></a>
<div class="header">
<p>
Next: <a href="#etsi_002drcvr-invocation" accesskey="n" rel="next"><code>etsi-rcvr</code> invocation</a>, Previous: <a href="#taxii_002dserver-invocation" accesskey="p" rel="prev"><code>taxii-server</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="nhis11_002drcvr-invocation-1"></a>
<h3 class="section">6.19 <code>nhis11-rcvr</code> invocation</h3>

<a name="index-nhis11_002drcvr_002c-invocation"></a>

<p><code>nhis11-rcvr</code> provides a TCP server which accepts connections from
NHIS LI clients,  decodes NHIS LI streams and outputs contained IP  packets  on
the standard output in PCAP format.  TCP port number to use is provided
on the command line.  Synopsis:
</p>
<div class="example">
<pre class="example">nhis11-rcvr <var>port-number</var>

</pre></div>

<ul>
<li> <var>port-number</var> is the TCP port number to list to for connections.
See <a href="#NHIS-LI">NHIS LI</a>.

</li></ul>

<a name="index-cyberprobe_002c-configuration-2"></a>

<p><code>nhis11-rcvr</code> executes indefinitely - to end the program, a signal
should be sent. e.g.
</p>
<div class="example">
<pre class="example">killall nhis11-rcvr
</pre></div>


<hr>
<a name="etsi_002drcvr-invocation"></a>
<div class="header">
<p>
Next: <a href="#ElasticSearch-model" accesskey="n" rel="next">ElasticSearch model</a>, Previous: <a href="#nhis11_002drcvr-invocation" accesskey="p" rel="prev"><code>nhis11-rcvr</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="etsi_002drcvr-invocation-1"></a>
<h3 class="section">6.20 <code>etsi-rcvr</code> invocation</h3>

<a name="index-etsi_002drcvr_002c-invocation"></a>

<p><code>etsi-rcvr</code> provides a TCP server which accepts connections from
ETSI LI clients,  decodes ETSI LI streams and outputs contained IP  packets  on
the standard output in PCAP format.  TCP port number to use is provided
on the command line.  Synopsis:
</p>
<div class="example">
<pre class="example">etsi-rcvr <var>port-number</var>
</pre></div>

<ul>
<li> <var>port-number</var> is the TCP port number to list to for connections.
See <a href="#ETSI-LI">ETSI LI</a>.

</li></ul>

<a name="index-cyberprobe_002c-configuration-3"></a>

<p><code>etsi-rcvr</code> executes indefinitely - to end the program, a signal
should be sent. e.g.
</p>
<div class="example">
<pre class="example">killall etsi-rcvr
</pre></div>


<hr>
<a name="ElasticSearch-model"></a>
<div class="header">
<p>
Previous: <a href="#etsi_002drcvr-invocation" accesskey="p" rel="prev"><code>etsi-rcvr</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="ElasticSearch-model-1"></a>
<h3 class="section">6.21 ElasticSearch model</h3>
<a name="index-ElasticSearch-2"></a>
<a name="index-ElasticSearch_002c-model"></a>

<a name="Overview-4"></a>
<h3 class="heading">Overview</h3>

<a name="index-stix_002bdb_002elua-configuration-file-3"></a>
<a name="index-cybermon_002c-stix_002bdb_002elua-configuration-file-3"></a>
<p>When <code>cybermon</code> is used with the <samp>stix+db.lua</samp> or <samp>db.lua</samp>
configuration files, observations are created in an ElasticSearch database.
These configuration files call the <samp>elastic.lua</samp> utility module.
This section describes the data model used in the ElasticSearch database.
</p>
<p>ElasticSearch accepts data in JSON form.  <code>cybermon</code> uses an
index called <code>cyberprobe</code> and an object type <code>observation</code>.
</p>
<p>Here is an example of a JSON payload which is emitted for a DNS request:
</p><div class="example">
<pre class="example">{
  &quot;observation&quot;: {
    &quot;type&quot;: &quot;query&quot;,
    &quot;answers&quot;: {},
    &quot;liid&quot;: &quot;123456&quot;,
    &quot;dest&quot;: {
      &quot;udp&quot;: [&quot;53&quot;],
      &quot;dns&quot;: [&quot;&quot;],
      &quot;ipv4&quot;: [&quot;192.168.1.1&quot;]
    },
    &quot;queries&quot;: [
      &quot;news.bbc.co.uk&quot;
    ],
    &quot;src&quot;: {
      &quot;udp&quot;: [&quot;57291&quot;],
      &quot;dns&quot;: [&quot;&quot;],
      &quot;ipv4&quot;: [&quot;192.168.1.100&quot;]
    },
    &quot;time&quot;: &quot;20141018T175059.366Z&quot;,
    &quot;action&quot;: &quot;dns_message&quot;,
    &quot;oid&quot;: 1
  }
}
</pre></div>

<a name="Common-fields"></a>
<h3 class="heading">Common fields</h3>

<p>The following fields are emitted for all observations:
</p>
<dl compact="compact">
<dt><code>observation</code></dt>
<dd><p>This is a JSON object which describes a Cyberprobe observation.
</p>
</dd>
<dt><code>observation.oid</code></dt>
<dd><p>A unique object ID.
</p>
</dd>
<dt><code>observation.time</code></dt>
<dd><p>Describes the time of the event in GMT.  The components are:
</p><ul>
<li> 4-digit year
</li><li> 2-digit month
</li><li> 2-digit date
</li><li> Literal &lsquo;<samp>T</samp>&rsquo;.
</li><li> 2-digit hour (24-hour).
</li><li> 2-digit minute
</li><li> 2-digit second
</li><li> Literal &lsquo;<samp>.</samp>&rsquo;
</li><li> 3-digit milliseconds
</li><li> Literal &lsquo;<samp>Z</samp>&rsquo;
</li></ul>
<p>e.g. <code>20141018T175059.366Z</code>.
</p></dd>
<dt><code>observation.liid</code></dt>
<dd><a name="index-LIID-1"></a>
<p>A string containing the targeted LIID.
</p>
</dd>
<dt><code>observation.action</code></dt>
<dd><p>Describes the type of a Cyberprobe observation.  See <a href="#Actions">Actions</a>
below.
</p>
</dd>
<dt><code>observation.src</code></dt>
<dd><p>An object describing the full stack of protocol destination addresses.
For each name/value pair, the name is the protocol name, and the value
is an array of strings which are protocol addresses.  For example:
</p><div class="example">
<pre class="example">&quot;src&quot;: {
  &quot;udp&quot;: [&quot;57291&quot;],
  &quot;dns&quot;: [&quot;&quot;],
  &quot;ipv4&quot;: [&quot;192.168.1.100&quot;]
}
</pre></div>

<p>This specifies a UDP source port number of 57291, and an IP source address
of <code>192.168.1.100</code>.  Each protocol layer is list, allowing for more than
one address - protocol tunnels may result in more than IP address, for instance.
</p>
</dd>
<dt><code>observation.dest</code></dt>
<dd><p>An object describing the full stack of protocol destination addresses, like
<code>observation.src</code> above, but for destination addresses.
</p>
</dd>
</dl>

<a name="Actions-1"></a>
<h3 class="heading">Actions</h3>
<a name="Actions"></a><a name="index-ElasticSearch-model_002c-actions"></a>
<a name="index-Actions"></a>

<p>The following <code>action</code> fields are defined:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>connected_up</samp>&rsquo;</dt>
<dd><p>Records the creation of a stream-orientated connection (currently, only TCP).
This event is created for all connections whether the protocol is
recognised or not.
</p></dd>
<dt>&lsquo;<samp>connected_down</samp>&rsquo;</dt>
<dd><p>Records the closing of a stream-orientated connection (currently, only TCP).
This event is created for all connections whether the protocol is
recognised or not.
</p></dd>
<dt>&lsquo;<samp>unrecognised_stream</samp>&rsquo;</dt>
<dd><p>Records the sending of a PDU on a connection-less transport (currently, only
UDP) whose protocol has not been recognised.
</p></dd>
<dt>&lsquo;<samp>unrecognised_datagram</samp>&rsquo;</dt>
<dd><p>Records the sending of a PDU on a connection-less transport (currently, only
UDP) whose protocol has not been recognised.
</p></dd>
<dt>&lsquo;<samp>http_request</samp>&rsquo;</dt>
<dd><p>Records the sending of an HTTP request.
</p></dd>
<dt>&lsquo;<samp>http_response</samp>&rsquo;</dt>
<dd><p>Records the sending of an HTTP response.
</p></dd>
<dt>&lsquo;<samp>dns_message</samp>&rsquo;</dt>
<dd><p>Records the sending of a DNS message (request and response).
</p></dd>
<dt>&lsquo;<samp>icmp</samp>&rsquo;</dt>
<dd><p>Records the sending of an ICMP message.
</p></dd>
<dt>&lsquo;<samp>smtp_command</samp>&rsquo;</dt>
<dd><p>Records the sending of an SMTP command.  This is a message from client
to server.  Data commands are not recorded with this event - there is an
&lsquo;<samp>smtp_data</samp>&rsquo; event which records this.
</p></dd>
<dt>&lsquo;<samp>smtp_response</samp>&rsquo;</dt>
<dd><p>Records the sending of a response to an SMTP command.  This is a status
message from server to client.
</p></dd>
<dt>&lsquo;<samp>smtp_data</samp>&rsquo;</dt>
<dd><p>Records an SMTP data transaction, including the full SMTP data payload
(essentially an email).
</p></dd>
<dt>&lsquo;<samp>ftp_command</samp>&rsquo;</dt>
<dd><p>Records an FTP command (client to server).
</p></dd>
<dt>&lsquo;<samp>ftp_response</samp>&rsquo;</dt>
<dd><p>Records an FTP response (server to client).
</p></dd>
</dl>

<a name="Connection-up"></a>
<h3 class="heading">Connection up</h3>
<a name="index-Connection-up"></a>

<p>Connection up events are created when connection-orientated transports
(e.g. TCP) are created, and have an <code>action</code> field of &lsquo;<samp>connection_up</samp>&rsquo;.
</p>
<a name="Connection-down"></a>
<h3 class="heading">Connection down</h3>
<a name="index-Connection-down"></a>

<p>Connection down events are created when connection-orientated transports
(e.g. TCP) are closed and have an <code>action</code> field of &lsquo;<samp>connection_down</samp>&rsquo;.
</p>
<a name="Unrecognised-datagram"></a>
<h3 class="heading">Unrecognised datagram</h3>
<a name="index-Unrecognised-datagram"></a>

<p>Unrecognised datagram events are created when a datagram is observed
on an unrecognised protocol, and have an <code>action</code> field of
&lsquo;<samp>unrecognised_datagram</samp>&rsquo;.  Such events include the following fields:
</p><dl compact="compact">
<dt><code>observation.data</code></dt>
<dd><p>The datagram payload, base64 encoded.
</p></dd>
</dl>

<a name="Unrecognised-stream"></a>
<h3 class="heading">Unrecognised stream</h3>
<a name="index-Unrecognised-stream"></a>

<p>Unrecognised stream events are created when data is observed to be
sent on an unrecognised connection-orientated protocol (e.g. TCP),
and have an <code>action</code> field of
&lsquo;<samp>unrecognised_stream</samp>&rsquo;.  Such events include the following fields:
</p><dl compact="compact">
<dt><code>observation.data</code></dt>
<dd><p>The datagram payload, base64 encoded.
</p></dd>
</dl>

<a name="ICMP"></a>
<h3 class="heading">ICMP</h3>
<a name="index-ICMP"></a>

<p>ICMP events are created when an ICMP message is observed
and have an <code>action</code> field of &lsquo;<samp>icmp</samp>&rsquo;.  Such events include the
following fields:
</p><dl compact="compact">
<dt><code>observation.data</code></dt>
<dd><p>The datagram payload, base64 encoded.
</p></dd>
</dl>

<a name="DNS-messages"></a>
<h3 class="heading">DNS messages</h3>

<p>DNS events are created for DNS query and response messages, and have an
<code>action</code> field of &lsquo;<samp>dns_message</samp>&rsquo;.  Such events include
the following fields:
</p>
<dl compact="compact">
<dt><code>observation.type</code></dt>
<dd><p>Used to describe the type of a DNS message, by interpreting the message flags.
Will be &lsquo;<samp>query</samp>&rsquo; or &lsquo;<samp>response</samp>&rsquo;.
</p>
</dd>
<dt><code>observation.queries</code></dt>
<dd><p>Contains a list of DNS queries.  Example:
</p><div class="example">
<pre class="example">&quot;queries&quot;:[
  &quot;news.bbc.co.uk&quot;
]
</pre></div>

</dd>
<dt><code>observation.answers</code></dt>
<dd><p>Contains a list of DNS responses.  Example:
</p><div class="example">
<pre class="example">&quot;answers&quot;: [
  {
    &quot;name&quot;: &quot;newswww.bbc.net.uk&quot;
  },
  {
    &quot;address&quot;: &quot;212.58.246.85&quot;,
    &quot;name&quot;: &quot;newswww.bbc.net.uk&quot;
  },
  {
    &quot;address&quot;: &quot;212.58.246.84&quot;,
    &quot;name&quot;: &quot;newswww.bbc.net.uk&quot;
  }
]
</pre></div>

</dd>
</dl>

<a name="HTTP-request"></a>
<h3 class="heading">HTTP request</h3>
<a name="index-HTTP-request"></a>

<p>HTTP request events are created for HTTP requests, and have an
<code>action</code> field of &lsquo;<samp>http_request</samp>&rsquo;.  Such events include fields:
</p>
<dl compact="compact">
<dt><code>observation.method</code></dt>
<dd><p>The HTTP method e.g. &lsquo;<samp>GET</samp>&rsquo;, &lsquo;<samp>POST</samp>&rsquo;.
</p>
</dd>
<dt><code>observation.url</code></dt>
<dd><p>The HTTP URL e.g. &lsquo;<samp>http://www.bbc.co.uk/index.html</samp>&rsquo;.
</p>
</dd>
<dt><code>observation.header</code></dt>
<dd><p>An object containing the request headers e.g.
</p><div class="example">
<pre class="example">{
  &quot;Accept&quot;: &quot;*\/*&quot;,
  &quot;Referer&quot;: &quot;http:\/\/www.bbc.co.uk\/news\/&quot;,
  &quot;Accept-Language&quot;: &quot;en-gb,en;q=0.5&quot;,
  &quot;Host&quot;: &quot;www.bbc.co.uk&quot;,
  &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,
  &quot;Connection&quot;: &quot;keep-alive&quot;,
  &quot;User-Agent&quot;: &quot;Test/5.0&quot;
}
</pre></div>

</dd>
<dt><code>observation.body</code></dt>
<dd><p>Describes the HTTP body.  This is a base64 encoding of the body.
</p>
</dd>
</dl>

<a name="HTTP-response"></a>
<h3 class="heading">HTTP response</h3>
<a name="index-HTTP-response"></a>

<p>HTTP response events are created for responses to HTTP requests, and have an
<code>action</code> field of &lsquo;<samp>http_response</samp>&rsquo;.  Such events include
the following fields:
</p>
<dl compact="compact">
<dt><code>observation.code</code></dt>
<dd><p>The HTTP status code e.g. &lsquo;<samp>200</samp>&rsquo;.
</p>
</dd>
<dt><code>observation.status</code></dt>
<dd><p>The HTTP status response e.g. &lsquo;<samp>OK</samp>&rsquo;.
</p>
</dd>
<dt><code>observation.url</code></dt>
<dd><p>The HTTP URL e.g. &lsquo;<samp>http://www.bbc.co.uk/index.html</samp>&rsquo;.  This is obtained
by studying the HTTP request, so will only be present where the HTTP
request is observed.
</p>
</dd>
<dt><code>observation.header</code></dt>
<dd><p>An object containing the response headers e.g.
</p><div class="example">
<pre class="example">{
  &quot;Server&quot;: &quot;Apache&quot;,
  &quot;Content-Type&quot;: &quot;text/javascript&quot;
}
</pre></div>

</dd>
<dt><code>observation.body</code></dt>
<dd><p>Describes the HTTP response body, base64 encoded.
</p>
</dd>
</dl>

<a name="SMTP-command"></a>
<h3 class="heading">SMTP command</h3>
<a name="index-SMTP-command"></a>

<p>SMTP commands events are created when an SMTP command is sent from client
to server, and have an <code>action</code> field of &lsquo;<samp>smtp_command</samp>&rsquo;.
Such events include the
following fields:
</p><dl compact="compact">
<dt><code>observation.command</code></dt>
<dd><p>The SMTP command e.g. &lsquo;<samp>EHLO</samp>&rsquo;.
</p></dd>
</dl>

<a name="SMTP-response"></a>
<h3 class="heading">SMTP response</h3>
<a name="index-SMTP-response"></a>

<p>SMTP response events are created when an SMTP response is sent from server
to client, and have an <code>action</code> field of &lsquo;<samp>smtp_response</samp>&rsquo;.
Such events include the following fields:
</p>
<dl compact="compact">
<dt><code>observation.status</code></dt>
<dd><p>The SMTP status e.g. &lsquo;<samp>400</samp>&rsquo;.
</p></dd>
<dt><code>observation.text</code></dt>
<dd><p>The SMTP text e.g. &lsquo;<samp>[&quot;Hello malware.com.  Pleased to meet you.&quot;]</samp>&rsquo;.
</p></dd>
</dl>

<a name="SMTP-data"></a>
<h3 class="heading">SMTP data</h3>
<a name="index-SMTP-data"></a>

<p>SMTP data events are created when an SMTP email is sent from client
to server, and have an <code>action</code> field of &lsquo;<samp>smtp_data</samp>&rsquo;.
Such events include the following fields:
</p>
<dl compact="compact">
<dt><code>observation.from</code></dt>
<dd><p>The SMTP &ldquo;from&rdquo; address.  A string.
</p></dd>
<dt><code>observation.to</code></dt>
<dd><p>The SMTP &ldquo;to&rdquo; addresses.  An array of strings.
</p></dd>
<dt><code>observation.data</code></dt>
<dd><p>The SMTP payload (RFC822), base64 encoded.
</p></dd>
</dl>

<a name="FTP-command"></a>
<h3 class="heading">FTP command</h3>
<a name="index-FTP-command"></a>

<p>FTP commands events are created when an FTP command is sent from client
to server, and have an <code>action</code> field of &lsquo;<samp>ftp_command</samp>&rsquo;.
Such events include the
following fields:
</p><dl compact="compact">
<dt><code>observation.command</code></dt>
<dd><p>The FTP command.
</p></dd>
</dl>

<a name="FTP-response"></a>
<h3 class="heading">FTP response</h3>
<a name="index-FTP-response"></a>

<p>FTP response events are created when an FTP response is sent from server
to client, and have an <code>action</code> field of &lsquo;<samp>ftp_response</samp>&rsquo;.
Such events include the following fields:
</p>
<dl compact="compact">
<dt><code>observation.status</code></dt>
<dd><p>The FTP status.
</p></dd>
<dt><code>observation.text</code></dt>
<dd><p>The FTP text.
</p></dd>
</dl>


<hr>
<a name="Architecture"></a>
<div class="header">
<p>
Next: <a href="#Adding-a-map-to-the-dashboard" accesskey="n" rel="next">Adding a map to the dashboard</a>, Previous: <a href="#Reference" accesskey="p" rel="prev">Reference</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Architecture-1"></a>
<h2 class="chapter">7 Architecture</h2>
<a name="index-Cyberprobe_002c-architecture"></a>
<a name="index-Architecture"></a>

<img src="architecture.png" alt="png">

<p>Cyberprobe consists of a set of loosely-coupled components which can be
used together. We prefer to use simple interfaces, and prefer to use
interfaces which are standards. Here&rsquo;s how we envisage these components
being used:
</p>
<dl compact="compact">
<dt><code>cyberprobe</code></dt>
<dd><p>is a network sniffer which collects packets which match an IP address
list. The packets collected are streamed using network streaming
protocols. The IP address match list can be statically configured (in a
configuration file), can be dynamically changed using a management
interface, or can be dynamically changed as a result of Snort alerts.
</p>
</dd>
<dt><code>cybermon</code></dt>
<dd><p>receives packets from cyberprobe, analyses them and generates
session/transport level events which result in user-configurable
actions. For each event, a call is made to a Lua script which the caller
provides.
</p>
</dd>
<dt><code>stix+db.lua</code></dt>
<dd><a name="index-stix_002bdb_002elua-configuration-file-4"></a>
<a name="index-cybermon_002c-stix_002bdb_002elua-configuration-file-4"></a>
<p>is a cybermon configuration file we provide. It translates the cybermon
events into a JSON description which is fed into an ElasticSearch
database. This configuration file also reads a STIX configuration file for
cyber threat indicators. When these indicators are observed, the indicator
meta-data is also added to the JSON events.
</p>
</dd>
<dt><code>zeromq.lua</code></dt>
<dd><a name="index-zeromq_002elua-configuration-file"></a>
<a name="index-cybermon_002c-zeromq_002elua-configuration-file"></a>
<p>is a cybermon configuration file we provide which publishes data to a
ZeroMQ pub/sub queue.  It allows connection of consumers to the
<code>cybermon</code> event stream.
</p>
</dd>
<dt><code>cybermon-bigquery</code></dt>
<dd><a name="index-cybermon_002dbigquery-1"></a>
<a name="index-Google-BigQuery-1"></a>
<a name="index-BigQuery"></a>
<p>is a ZeroMQ subscriber which output <code>cybermon</code> events to a
Google BigQuery table.
</p>
</dd>
<dt><code>cybermon-cassandra</code></dt>
<dd><a name="index-cybermon_002dcassanra"></a>
<a name="index-Cassandra-2"></a>
<a name="index-Apache-Cassandra-2"></a>
<p>is a ZeroMQ subscriber which output <code>cybermon</code> events to a
Cassandra store.
</p>
</dd>
<dt><code>cybermon-elasticsearch</code></dt>
<dd><a name="index-cybermon_002delasticsearch-1"></a>
<a name="index-ElasticSearch-3"></a>
<p>is a ZeroMQ subscriber which output <code>cybermon</code> events to a
ElasticSearch store.
</p>
</dd>
<dt><code>cybermon-gaffer</code></dt>
<dd><a name="index-cybermon_002dgaffer-1"></a>
<a name="index-Gaffer-2"></a>
<p>is a ZeroMQ subscriber which output <code>cybermon</code> events to a
Gaffer store.
</p>
</dd>
<dt><code>taxii-server</code></dt>
<dd><p>is a TAXII compliant server, which is used to distribute STIX rules over
HTTP.
</p>
</dd>
<dt><code>taxii-client-json</code></dt>
<dd><p>is a TAXII compliant client, which fetches STIX data over TAXII and write it
to a JSON file in a way that <code>stix+db.lua</code> can read.
</p>
</dd>
<dt><code>snort</code></dt>
<dd><p>is not part of cyberprobe, but it&rsquo;s a great NIDS, so we use that.
</p>
</dd>
</dl>


<hr>
<a name="Adding-a-map-to-the-dashboard"></a>
<div class="header">
<p>
Next: <a href="#GNU-Free-Documentation-License" accesskey="n" rel="next">GNU Free Documentation License</a>, Previous: <a href="#Architecture" accesskey="p" rel="prev">Architecture</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Adding-a-map-to-the-dashboard-1"></a>
<h2 class="appendix">Appendix A Adding a map to the dashboard</h2>
<a name="index-GeoIP"></a>
<a name="index-Dashboard-1"></a>
<a name="index-Map-on-the-dashboard"></a>
<a name="index-Map-widget"></a>
<a name="index-IP-event-location"></a>

<blockquote>
<p><b>Note:</b> FIXME: This bit of the documentation is out of date with respect to the
main documentation.
</p></blockquote>

<p>Wouldn&rsquo;t it be good if our
visual dashboard had a world map that showed the source of packets?
This last bit involves some experimental software.
</p>
<p>First step is to get hold of a database which maps IP addresses to countries.
There are several, but the GeoIP database is widely available and free.
Check out the licence for yourself, though.  The packages for your distribution
are probably called GeoIP-devel and GeoIP.  Debian has libgeoip-dev.
So, install those with your favourite package manager.  On Redhat/Fedora:
</p><div class="example">
<pre class="example">sudo yum install GeoIP-devel and GeoIP
</pre></div>
<p>or Debian/Ubuntu:
</p><div class="example">
<pre class="example">sudo apt-get install geoip-database # GeoLite Country only
sudo apt-get install libgeoip-dev
</pre></div>

<p>Next step is to download the database:
</p><div class="example">
<pre class="example">geoipupdate
</pre></div>

<p>Next, we need Lua support for GeoIP.  First, download:
</p><div class="example">
<pre class="example">mkdir lua-geoip
cd lua-geoip
wget \
http://files.luaforge.net/releases/geoip/geoip/0.1-1/\
geoip-0.1-1.tar.gz
tar xvfz geoip-0.1-1.tar.gz
cd geoip-0.1-1
</pre></div>
<p>On my distribution, the code doesn&rsquo;t compile, so need to apply a patch 
which I have stashed in the cyberprobe source code.
</p><div class="example">
<pre class="example"># Check patch applies without error.
patch -p1 --dry-run  &lt; ../../lua-geoip.patch
# Apply patch for real.
patch -p1  &lt; ../../geoip.patch
</pre></div>
<p>Finally, the Makefile supplied doesn&rsquo;t work, so compile by hand:
</p><div class="example">
<pre class="example">gcc -fPIC -c geoip.c -o geoip.o
gcc -shared geoip.o -o geoip.so -lGeoIP
</pre></div>
<p>At this point, you should have a file <samp>geoip.so</samp>.  You should test whether
it loads in Lua.  You type the bits after the &lsquo;<samp>&gt;</samp>&rsquo; prompt:
</p><div class="example">
<pre class="example">$ lua
Lua 5.2.2  Copyright (C) 1994-2013 Lua.org, PUC-Rio
&gt; =require(&quot;geoip&quot;)
table: 0xf55bb0
&gt; =require(&quot;geoip&quot;).open_type
function: 0x7f738c9db24f
</pre></div>

<p>As long as you see a table and a function returned in Lua, this is good to go.
Next step, is to copy that geoip.so file to the place where you were running
<code>cybermon</code>.  It has to be in your current directory.  Then,
restart Cybermon, it should be loaded by the <samp>stix+db.lua</samp> configuration
file.
</p>
<p>Finally, on Kibana, load a new dashboard, instead of loading
<samp>kibana-dashboard.json</samp>, load <samp>kibana-dashboard-map.json</samp>, and
you&rsquo;ll see a map.  When sources of data are located to a particular location,
it will start to colour as the counts increase.
</p>
<p>As I say, we&rsquo;re reliant on some Lua software which doesn&rsquo;t seem to be
actively maintained, so you may have problems here.
</p>

<hr>
<a name="GNU-Free-Documentation-License"></a>
<div class="header">
<p>
Next: <a href="#Index" accesskey="n" rel="next">Index</a>, Previous: <a href="#Adding-a-map-to-the-dashboard" accesskey="p" rel="prev">Adding a map to the dashboard</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="GNU-Free-Documentation-License-1"></a>
<h2 class="appendix">Appendix B GNU Free Documentation License</h2>

<div align="center">Version 1.3, 3 November 2008
</div>

<div class="display">
<pre class="display">Copyright &copy; 2013-2014 Cyber MacGeddon
<a href="http://cyberprobe.sf.net/">http://cyberprobe.sf.net/</a>

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
</pre></div>

<ol>
<li> PREAMBLE

<p>The purpose of this License is to make a manual, textbook, or other
functional and useful document <em>free</em> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially.
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.
</p>
<p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.
</p>
<p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.
</p>
</li><li> APPLICABILITY AND DEFINITIONS

<p>This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The &ldquo;Document&rdquo;, below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as &ldquo;you&rdquo;.  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.
</p>
<p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.
</p>
<p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document&rsquo;s overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.
</p>
<p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.
</p>
<p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.
</p>
<p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent.
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.
</p>
<p>Examples of suitable formats for Transparent copies include plain
ASCII without markup, Texinfo input format, LaTeX input
format, SGML or XML using a publicly available
DTD, and standard-conforming simple HTML,
PostScript or PDF designed for human modification.  Examples
of transparent image formats include PNG, XCF and
JPG.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, SGML or
XML for which the DTD and/or processing tools are
not generally available, and the machine-generated HTML,
PostScript or PDF produced by some word processors for
output purposes only.
</p>
<p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work&rsquo;s title,
preceding the beginning of the body of the text.
</p>
<p>The &ldquo;publisher&rdquo; means any person or entity that distributes copies
of the Document to the public.
</p>
<p>A section &ldquo;Entitled XYZ&rdquo; means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, &ldquo;Endorsements&rdquo;, or &ldquo;History&rdquo;.)  To &ldquo;Preserve the Title&rdquo;
of such a section when you modify the Document means that it remains a
section &ldquo;Entitled XYZ&rdquo; according to this definition.
</p>
<p>The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.
</p>
</li><li> VERBATIM COPYING

<p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.
</p>
<p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.
</p>
</li><li> COPYING IN QUANTITY

<p>If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document&rsquo;s license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition.
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.
</p>
<p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.
</p>
<p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material.
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.
</p>
<p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.
</p>
</li><li> MODIFICATIONS

<p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:
</p>
<ol>
<li> Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

</li><li> List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.

</li><li> State on the Title page the name of the publisher of the
Modified Version, as the publisher.

</li><li> Preserve all the copyright notices of the Document.

</li><li> Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

</li><li> Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

</li><li> Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document&rsquo;s license notice.

</li><li> Include an unaltered copy of this License.

</li><li> Preserve the section Entitled &ldquo;History&rdquo;, Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

</li><li> Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section.
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

</li><li> For any section Entitled &ldquo;Acknowledgements&rdquo; or &ldquo;Dedications&rdquo;, Preserve
the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.

</li><li> Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

</li><li> Delete any section Entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

</li><li> Do not retitle any existing section to be Entitled &ldquo;Endorsements&rdquo; or
to conflict in title with any Invariant Section.

</li><li> Preserve any Warranty Disclaimers.
</li></ol>

<p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version&rsquo;s license notice.
These titles must be distinct from any other section titles.
</p>
<p>You may add a section Entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.
</p>
<p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.
</p>
<p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.
</p>
</li><li> COMBINING DOCUMENTS

<p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.
</p>
<p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number.
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.
</p>
<p>In the combination, you must combine any sections Entitled &ldquo;History&rdquo;
in the various original documents, forming one section Entitled
&ldquo;History&rdquo;; likewise combine any sections Entitled &ldquo;Acknowledgements&rdquo;,
and any sections Entitled &ldquo;Dedications&rdquo;.  You must delete all
sections Entitled &ldquo;Endorsements.&rdquo;
</p>
</li><li> COLLECTIONS OF DOCUMENTS

<p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.
</p>
<p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.
</p>
</li><li> AGGREGATION WITH INDEPENDENT WORKS

<p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an &ldquo;aggregate&rdquo; if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation&rsquo;s users beyond what the individual works permit.
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.
</p>
<p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document&rsquo;s Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form.
Otherwise they must appear on printed covers that bracket the whole
aggregate.
</p>
</li><li> TRANSLATION

<p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4.
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.
</p>
<p>If a section in the Document is Entitled &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, or &ldquo;History&rdquo;, the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.
</p>
</li><li> TERMINATION

<p>You may not copy, modify, sublicense, or distribute the Document
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense, or distribute it is void, and
will automatically terminate your rights under this License.
</p>
<p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.
</p>
<p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.
</p>
<p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, receipt of a copy of some or all of the same material does
not give you any rights to use it.
</p>
</li><li> FUTURE REVISIONS OF THIS LICENSE

<p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.
</p>
<p>Each version of the License is given a distinguishing version number.
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.  If the Document
specifies that a proxy can decide which future versions of this
License can be used, that proxy&rsquo;s public statement of acceptance of a
version permanently authorizes you to choose that version for the
Document.
</p>
</li><li> RELICENSING

<p>&ldquo;Massive Multiauthor Collaboration Site&rdquo; (or &ldquo;MMC Site&rdquo;) means any
World Wide Web server that publishes copyrightable works and also
provides prominent facilities for anybody to edit those works.  A
public wiki that anybody can edit is an example of such a server.  A
&ldquo;Massive Multiauthor Collaboration&rdquo; (or &ldquo;MMC&rdquo;) contained in the
site means any set of copyrightable works thus published on the MMC
site.
</p>
<p>&ldquo;CC-BY-SA&rdquo; means the Creative Commons Attribution-Share Alike 3.0
license published by Creative Commons Corporation, a not-for-profit
corporation with a principal place of business in San Francisco,
California, as well as future copyleft versions of that license
published by that same organization.
</p>
<p>&ldquo;Incorporate&rdquo; means to publish or republish a Document, in whole or
in part, as part of another Document.
</p>
<p>An MMC is &ldquo;eligible for relicensing&rdquo; if it is licensed under this
License, and if all works that were first published under this License
somewhere other than this MMC, and subsequently incorporated in whole
or in part into the MMC, (1) had no cover texts or invariant sections,
and (2) were thus incorporated prior to November 1, 2008.
</p>
<p>The operator of an MMC Site may republish an MMC contained in the site
under CC-BY-SA on the same site at any time before August 1, 2009,
provided the MMC is eligible for relicensing.
</p>
</li></ol>

<a name="ADDENDUM_003a-How-to-use-this-License-for-your-documents"></a>
<h3 class="heading">ADDENDUM: How to use this License for your documents</h3>

<p>To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and
license notices just after the title page:
</p>
<div class="smallexample">
<pre class="smallexample">  Copyright (C)  <var>year</var>  <var>your name</var>.
  Permission is granted to copy, distribute and/or modify this document
  under the terms of the GNU Free Documentation License, Version 1.3
  or any later version published by the Free Software Foundation;
  with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
  Texts.  A copy of the license is included in the section entitled ``GNU
  Free Documentation License''.
</pre></div>

<p>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
replace the &ldquo;with&hellip;Texts.&rdquo; line with this:
</p>
<div class="smallexample">
<pre class="smallexample">    with the Invariant Sections being <var>list their titles</var>, with
    the Front-Cover Texts being <var>list</var>, and with the Back-Cover Texts
    being <var>list</var>.
</pre></div>

<p>If you have Invariant Sections without Cover Texts, or some other
combination of the three, merge those two alternatives to suit the
situation.
</p>
<p>If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License,
to permit their use in free software.
</p>

<hr>
<a name="Index"></a>
<div class="header">
<p>
Previous: <a href="#GNU-Free-Documentation-License" accesskey="p" rel="prev">GNU Free Documentation License</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Index-1"></a>
<h2 class="unnumbered">Index</h2>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-V"><b>V</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-Z"><b>Z</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-cp" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Actions">Actions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Apache-Cassandra">Apache Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Cassandra-subscriber">The Cassandra subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Apache-Cassandra-1">Apache Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Apache-Cassandra-2">Apache Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Architecture">Architecture</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Authentication">Authentication</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Management-interface">Management interface</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-BigQuery">BigQuery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Boost">Boost</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Build-dependencies">Build dependencies</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Build-targets">Build targets</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Building">Building</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cassandra">Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Cassandra-subscriber">The Cassandra subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cassandra-1">Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cassandra-2">Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-certificate_002c-cyberprobe-configuration-option"><code>certificate</code>, cyberprobe configuration option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Checkout-from-git-repository">Checkout from <code>git</code> repository</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Compilation">Compilation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Connection-down">Connection down</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Connection-reset">Connection reset</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Connection-restart">Connection restart</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Connection-up">Connection up</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-connection_005fup"><code>connection_up</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Containers">Containers</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-context"><code>context</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-context-object"><code>context</code> object</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-control"><code>control</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cyber-threat-indicators">Cyber threat indicators</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cybermaggedon">Cybermaggedon</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon"><code>cybermon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon-1"><code>cybermon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cybermon">Using <code>cybermon</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon-context-object"><code>cybermon</code> <code>context</code> object</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon-events"><code>cybermon</code> events</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cybermon-ZeroMQ-message-format">Cybermon ZeroMQ message format</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cybermon-ZeroMQ-message-format-1">Cybermon ZeroMQ message format</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-ZeroMQ-message-format">Cybermon ZeroMQ message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-configuration"><code>cybermon</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cybermon">Using <code>cybermon</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-configuration-1"><code>cybermon</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-docker-repository"><code>cybermon</code>, docker repository</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-example-configurations"><code>cybermon</code>, example configurations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-features"><code>cybermon</code>, features</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-invocation"><code>cybermon</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-invocation"><code>cybermon</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-pub_002fsub"><code>cybermon</code>, pub/sub</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-cyberprobe_002fcybermon">Running cyberprobe/cybermon</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-pub_002fsub-1"><code>cybermon</code>, pub/sub</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pub_002fsub-overview">Pub/sub overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-stix_002balert_002elua-configuration-file"><code>cybermon</code>, <samp>stix+alert.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-stix_002balert_002elua-configuration-file-1"><code>cybermon</code>, <samp>stix+alert.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-stix_002balert_002elua-configuration-file-2"><code>cybermon</code>, <samp>stix+alert.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#taxii_002dsync_002djson-invocation"><code>taxii-sync-json</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-stix_002bdb_002elua-configuration-file"><code>cybermon</code>, <samp>stix+db.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-stix_002bdb_002elua-configuration-file-1"><code>cybermon</code>, <samp>stix+db.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-stix_002bdb_002elua-configuration-file-2"><code>cybermon</code>, <samp>stix+db.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#taxii_002dsync_002djson-invocation"><code>taxii-sync-json</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-stix_002bdb_002elua-configuration-file-3"><code>cybermon</code>, <samp>stix+db.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-stix_002bdb_002elua-configuration-file-4"><code>cybermon</code>, <samp>stix+db.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-zeromq_002elua-configuration-file"><code>cybermon</code>, <samp>zeromq.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dbigquery"><code>cybermon-bigquery</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dbigquery-1"><code>cybermon-bigquery</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dbigquery_002c-invocation"><code>cybermon-bigquery</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Google-BigQuery-subscriber">The Google BigQuery subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dbigquery_002c-invocation-1"><code>cybermon-bigquery</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dbigquery-invocation"><code>cybermon-bigquery</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dcassandra"><code>cybermon-cassandra</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dcassandra_002c-invocation"><code>cybermon-cassandra</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Cassandra-subscriber">The Cassandra subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dcassandra_002c-invocation-1"><code>cybermon-cassandra</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dcassanra"><code>cybermon-cassanra</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002delasticsearch"><code>cybermon-elasticsearch</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002delasticsearch-1"><code>cybermon-elasticsearch</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002delasticsearch_002c-invocation"><code>cybermon-elasticsearch</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-ElasticSearch-subscriber">The ElasticSearch subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002delasticsearch_002c-invocation-1"><code>cybermon-elasticsearch</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002delasticsearch-invocation"><code>cybermon-elasticsearch</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dgaffer"><code>cybermon-gaffer</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dgaffer-1"><code>cybermon-gaffer</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dgaffer_002c-invocation"><code>cybermon-gaffer</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Gaffer-subscriber">The Gaffer subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dgaffer_002c-invocation-1"><code>cybermon-gaffer</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dgaffer-invocation"><code>cybermon-gaffer</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dmonitor_002c-invocation"><code>cybermon-monitor</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-debug-monitor-subscriber">The debug monitor subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dmonitor_002c-invocation-1"><code>cybermon-monitor</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dmonitor-invocation"><code>cybermon-monitor</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe"><code>cyberprobe</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe-1"><code>cyberprobe</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe-configuration"><code>cyberprobe</code> configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe-secure-delivery">cyberprobe secure delivery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cyberprobe_002c-architecture">Cyberprobe, architecture</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-configuration"><code>cyberprobe</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-invocation"><code>cyberprobe</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-configuration-1"><code>cyberprobe</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-configuration-2"><code>cyberprobe</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#nhis11_002drcvr-invocation"><code>nhis11-rcvr</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-configuration-3"><code>cyberprobe</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#etsi_002drcvr-invocation"><code>etsi-rcvr</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-control"><code>cyberprobe</code>, <code>control</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-delay"><code>cyberprobe</code>, delay</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-delay-1"><code>cyberprobe</code>, delay</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cyberprobe_002c-docker-repository">Cyberprobe, docker repository</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-docker-repository"><code>cyberprobe</code>, docker repository</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-endpoint"><code>cyberprobe</code>, endpoint</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-endpoints"><code>cyberprobe</code>, <code>endpoints</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-features"><code>cyberprobe</code>, features</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-interfaces"><code>cyberprobe</code>, <code>interfaces</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-invocation"><code>cyberprobe</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-invocation"><code>cyberprobe</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-management"><code>cyberprobe</code>, management</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Management-interface">Management interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cyberprobe_002c-motivation">Cyberprobe, motivation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-snort_005falert"><code>cyberprobe</code>, <code>snort_alert</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-target"><code>cyberprobe</code>, target</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-targets"><code>cyberprobe</code>, <code>targets</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002dcli"><code>cyberprobe-cli</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002dcli-1"><code>cyberprobe-cli</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Management-interface">Management interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002dcli_002c-commands"><code>cyberprobe-cli</code>, commands</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe_002dcli-commands"><code>cyberprobe-cli</code> commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002dcli_002c-invocation"><code>cyberprobe-cli</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe_002dcli-invocation"><code>cyberprobe-cli</code> invocation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard">Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard-1">Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Adding-a-map-to-the-dashboard">Adding a map to the dashboard</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Delay">Delay</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Delay-1">Delay</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dependencies">dependencies</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Discussion-forums">Discussion forums</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-DNS">DNS</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cybermon">Using <code>cybermon</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dns_005fmessage"><code>dns_message</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Docker">Docker</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Downloading">Downloading</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch">ElasticSearch</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch-1">ElasticSearch</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-ElasticSearch-subscriber">The ElasticSearch subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch-2">ElasticSearch</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch-3">ElasticSearch</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch-model_002c-actions">ElasticSearch model, actions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch_002c-model">ElasticSearch, model</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Endpoint">Endpoint</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-endpoints"><code>endpoints</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ETSI">ETSI</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ETSI-LI">ETSI LI</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ETSI-TS-101-671">ETSI TS 101 671</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ETSI-TS-102-232_002d1">ETSI TS 102 232-1</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ETSI-TS-102-232_002d3">ETSI TS 102 232-3</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-etsi_002drcvr"><code>etsi-rcvr</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-etsi_002drcvr-1"><code>etsi-rcvr</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-etsi_002drcvr_002c-invocation"><code>etsi-rcvr</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#etsi_002drcvr-invocation"><code>etsi-rcvr</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executables">Executables</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-expat"><code>expat</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Features_002c-of-cybermon">Features, of <code>cybermon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Features_002c-of-cyberprobe">Features, of <code>cyberprobe</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Forging_002c-DNS-response">Forging, DNS response</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FTP-command">FTP command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FTP-response">FTP response</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gaffer">Gaffer</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Gaffer-subscriber">The Gaffer subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gaffer-1">Gaffer</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dgaffer-invocation"><code>cybermon-gaffer</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gaffer-2">Gaffer</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GeoIP">GeoIP</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Adding-a-map-to-the-dashboard">Adding a map to the dashboard</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Getting-started">Getting started</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Quick-start-tutorial">Quick start tutorial</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-git-repository"><code>git</code> repository</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GLIC">GLIC</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Google-BigQuery">Google BigQuery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Google-BigQuery-subscriber">The Google BigQuery subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Google-BigQuery-1">Google BigQuery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Google-Cloud-Platform">Google Cloud Platform</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Google-BigQuery-subscriber">The Google BigQuery subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Graph-store">Graph store</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Cassandra-subscriber">The Cassandra subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Graph-store-1">Graph store</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Gaffer-subscriber">The Gaffer subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Graph-store-2">Graph store</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dgaffer-invocation"><code>cybermon-gaffer</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Graph-store-3">Graph store</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-H">H</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-hexdump_002elua"><samp>hexdump.lua</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cybermon">Using <code>cybermon</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HTTP-request">HTTP request</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HTTP-response">HTTP response</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-http_005fresponse"><code>http_response</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ICMP">ICMP</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ifconfig"><code>ifconfig</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Installation">Installation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Integration-with-snort">Integration with <code>snort</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-interfaces"><code>interfaces</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-IP-address-mask">IP address mask</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-IP-address-matching">IP address matching</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-IP-event-location">IP event location</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Adding-a-map-to-the-dashboard">Adding a map to the dashboard</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-J">J</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-JSON">JSON</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-K">K</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-key_002c-cyberprobe-configuration-option"><code>key</code>, cyberprobe configuration option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Kibana_002c-dashboard">Kibana, dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-libpcap"><code>libpcap</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-libtaxii"><code>libtaxii</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-libtaxii-1"><code>libtaxii</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LIID">LIID</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LIID-1">LIID</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Lua">Lua</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LUA-events">LUA events</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lua_002dmd5"><code>lua-md5</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-luafilesystem"><code>luafilesystem</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-luajson"><code>luajson</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Management">Management</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Management-interface">Management interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Management-client">Management client</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe_002dcli-invocation"><code>cyberprobe-cli</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Management-client-1">Management client</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe_002dcli-commands"><code>cyberprobe-cli</code> commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Management-protocol">Management protocol</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Management-protocol">Management protocol</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Map-on-the-dashboard">Map on the dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Adding-a-map-to-the-dashboard">Adding a map to the dashboard</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Map-widget">Map widget</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Adding-a-map-to-the-dashboard">Adding a map to the dashboard</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-monitor_002elua"><samp>monitor.lua</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cybermon">Using <code>cybermon</code></a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ncurses"><code>ncurses</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Network-parameters">Network parameters</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-NHIS-1_002e1">NHIS 1.1</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-NHIS-1_002e1-LI">NHIS 1.1 LI</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nhis11_002drcvr_002c-invocation"><code>nhis11-rcvr</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#nhis11_002drcvr-invocation"><code>nhis11-rcvr</code> invocation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Overview-of-Cyberprobe">Overview of Cyberprobe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packages">Packages</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packet-forgery">Packet forgery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packet-injection">Packet injection</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pip"><code>pip</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Privileged-user">Privileged user</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Prophesy-of-doom">Prophesy of doom</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pub_002fsub">pub/sub</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pub_002fsub-1">pub/sub</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-ZeroMQ-message-format">Cybermon ZeroMQ message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Pub_002fsub-delivery">Pub/sub delivery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-cyberprobe_002fcybermon">Running cyberprobe/cybermon</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Pub_002fsub-delivery-1">Pub/sub delivery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pub_002fsub-overview">Pub/sub overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-publish_002fsubscribe">publish/subscribe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-publish_002fsubscribe-1">publish/subscribe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-ZeroMQ-message-format">Cybermon ZeroMQ message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pyOpenSSL"><code>pyOpenSSL</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-readline"><code>readline</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Reconnection">Reconnection</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Release-history">Release history</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-SMTP-command">SMTP command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SMTP-data">SMTP data</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SMTP-response">SMTP response</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-snort-alerts"><code>snort</code> alerts</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-snort_002c-integration"><code>snort</code>, integration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-snort_002c-rules"><code>snort</code>, rules</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-snort_002c-signatures"><code>snort</code>, signatures</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-snort_005falert"><code>snort_alert</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SSL">SSL</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix"><code>stix</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-STIX">STIX</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix-1"><code>stix</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-STIX-indicators">STIX indicators</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix_002balert_002elua"><samp>stix+alert.lua</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix_002balert_002elua-configuration-file"><samp>stix+alert.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix_002balert_002elua-configuration-file-1"><samp>stix+alert.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix_002balert_002elua-configuration-file-2"><samp>stix+alert.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#taxii_002dsync_002djson-invocation"><code>taxii-sync-json</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix_002bdb_002elua-configuration-file"><samp>stix+db.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix_002bdb_002elua-configuration-file-1"><samp>stix+db.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix_002bdb_002elua-configuration-file-2"><samp>stix+db.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#taxii_002dsync_002djson-invocation"><code>taxii-sync-json</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix_002bdb_002elua-configuration-file-3"><samp>stix+db.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix_002bdb_002elua-configuration-file-4"><samp>stix+db.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix_002dcreate"><code>stix-create</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Storing-observations">Storing observations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Target">Target</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-targets"><code>targets</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-targets_002c-address-mask"><code>targets</code>, address mask</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TAXII">TAXII</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-taxii_002dclient"><code>taxii-client</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-taxii_002dclient_002c-invocation"><code>taxii-client</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#taxii_002dclient-invocation"><code>taxii-client</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-taxii_002dserver"><code>taxii-server</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-taxii_002dserver_002c-invocation"><code>taxii-server</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#taxii_002dserver-invocation"><code>taxii-server</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-taxii_002dsync_002djson"><code>taxii-sync-json</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-taxii_002dsync_002djson_002c-invocation"><code>taxii-sync-json</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#taxii_002dsync_002djson-invocation"><code>taxii-sync-json</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TCP-reset">TCP reset</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tcpdump"><code>tcpdump</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-telnet"><code>telnet</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Threat-indicators">Threat indicators</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators-using-STIX">Threat indicators using STIX</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TLS">TLS</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-trusted_002dca_002c-cyberprobe-configuration-option"><code>trusted-ca</code>, cyberprobe configuration option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TS-101-671">TS 101 671</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TS-102-232_002d1">TS 102 232-1</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TS-102-232_002d3">TS 102 232-3</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-U">U</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Unrecognised-datagram">Unrecognised datagram</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Unrecognised-stream">Unrecognised stream</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-V">V</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Version-history">Version history</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Visualisation">Visualisation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Index_cp_letter-Z">Z</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ZeroMQ">ZeroMQ</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ZeroMQ-1">ZeroMQ</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-ZeroMQ-message-format">Cybermon ZeroMQ message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-zeromq_002elua-configuration-file"><samp>zeromq.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-V"><b>V</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-Z"><b>Z</b></a>
 &nbsp; 
</td></tr></table>

<hr>



</body>
</html>
